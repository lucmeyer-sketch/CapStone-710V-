{"ast":null,"code":"import { supabase } from '../supabaseClient';\n// obtener todas las clases con relaciones\nexport const getAllClases = async () => {\n  const {\n    data,\n    error\n  } = await supabase.from('clases').select(`\n      *,\n      materia:materias (*),\n      docente:docentes (*)\n    `).order('grado', {\n    ascending: true\n  });\n  if (error) throw error;\n  return data || [];\n};\n\n// obtener clase por ID con relaciones\nexport const getClaseById = async id => {\n  const {\n    data,\n    error\n  } = await supabase.from('clases').select(`\n      *,\n      materia:materias (*),\n      docente:docentes (*)\n    `).eq('id', id).single();\n  if (error) throw error;\n  return data;\n};\n\n// obtener clases por grado y sección\nexport const getClasesByGradoSeccion = async (grado, seccion) => {\n  const {\n    data,\n    error\n  } = await supabase.from('clases').select(`\n      *,\n      materia:materias (*),\n      docente:docentes (*)\n    `).eq('grado', grado).eq('seccion', seccion).eq('estado', 'activo').order('materia.nombre', {\n    ascending: true\n  });\n  if (error) throw error;\n  return data || [];\n};\n\n// obtener clases de un docente\nexport const getClasesByDocente = async docenteId => {\n  // Obtener clases primero\n  const {\n    data: clasesData,\n    error: clasesError\n  } = await supabase.from('clases').select('*').eq('docente_id', docenteId).eq('estado', 'activo');\n  if (clasesError) throw clasesError;\n  if (!clasesData || clasesData.length === 0) return [];\n\n  // Obtener materias por separado\n  const materiaIds = Array.from(new Set(clasesData.map(clase => clase.materia_id).filter(id => id !== undefined && id !== null)));\n  let materiasData = [];\n  if (materiaIds.length > 0) {\n    const {\n      data,\n      error: materiasError\n    } = await supabase.from('materias').select('id, nombre, codigo').in('id', materiaIds);\n    if (materiasError) throw materiasError;\n    materiasData = data || [];\n  }\n\n  // Combinar datos\n  return clasesData.map(clase => ({\n    ...clase,\n    materia: materiasData.find(m => m.id === clase.materia_id) || null\n  }));\n};\n\n// crear clase\nexport const createClase = async clase => {\n  const {\n    data,\n    error\n  } = await supabase.from('clases').insert({\n    materia_id: clase.materia_id,\n    docente_id: clase.docente_id,\n    grado: clase.grado,\n    seccion: clase.seccion,\n    horario: clase.horario,\n    aula: clase.aula,\n    periodo: clase.periodo,\n    estado: clase.estado || 'activo'\n  }).select().single();\n  if (error) throw error;\n  return data;\n};\n\n// actualizar clase\nexport const updateClase = async (id, clase) => {\n  const {\n    data,\n    error\n  } = await supabase.from('clases').update(clase).eq('id', id).select().single();\n  if (error) throw error;\n  return data;\n};\n\n// eliminar clase\nexport const deleteClase = async id => {\n  const {\n    error\n  } = await supabase.from('clases').delete().eq('id', id);\n  if (error) throw error;\n};","map":{"version":3,"names":["supabase","getAllClases","data","error","from","select","order","ascending","getClaseById","id","eq","single","getClasesByGradoSeccion","grado","seccion","getClasesByDocente","docenteId","clasesData","clasesError","length","materiaIds","Array","Set","map","clase","materia_id","filter","undefined","materiasData","materiasError","in","materia","find","m","createClase","insert","docente_id","horario","aula","periodo","estado","updateClase","update","deleteClase","delete"],"sources":["C:/Users/diego/OneDrive/Escritorio/ProyectoAPT/CapStone-710V-/Proyecto/src/services/claseService.ts"],"sourcesContent":["import { supabase } from '../supabaseClient';\r\nimport { Clase } from '../types/database';\r\n\r\n// obtener todas las clases con relaciones\r\nexport const getAllClases = async (): Promise<Clase[]> => {\r\n  const { data, error } = await supabase\r\n    .from('clases')\r\n    .select(`\r\n      *,\r\n      materia:materias (*),\r\n      docente:docentes (*)\r\n    `)\r\n    .order('grado', { ascending: true });\r\n\r\n  if (error) throw error;\r\n  return data || [];\r\n};\r\n\r\n// obtener clase por ID con relaciones\r\nexport const getClaseById = async (id: string): Promise<Clase | null> => {\r\n  const { data, error } = await supabase\r\n    .from('clases')\r\n    .select(`\r\n      *,\r\n      materia:materias (*),\r\n      docente:docentes (*)\r\n    `)\r\n    .eq('id', id)\r\n    .single();\r\n\r\n  if (error) throw error;\r\n  return data;\r\n};\r\n\r\n// obtener clases por grado y sección\r\nexport const getClasesByGradoSeccion = async (\r\n  grado: string,\r\n  seccion: string\r\n): Promise<Clase[]> => {\r\n  const { data, error } = await supabase\r\n    .from('clases')\r\n    .select(`\r\n      *,\r\n      materia:materias (*),\r\n      docente:docentes (*)\r\n    `)\r\n    .eq('grado', grado)\r\n    .eq('seccion', seccion)\r\n    .eq('estado', 'activo')\r\n    .order('materia.nombre', { ascending: true });\r\n\r\n  if (error) throw error;\r\n  return data || [];\r\n};\r\n\r\n// obtener clases de un docente\r\nexport const getClasesByDocente = async (docenteId: string): Promise<Clase[]> => {\r\n  // Obtener clases primero\r\n  const { data: clasesData, error: clasesError } = await supabase\r\n    .from('clases')\r\n    .select('*')\r\n    .eq('docente_id', docenteId)\r\n    .eq('estado', 'activo');\r\n\r\n  if (clasesError) throw clasesError;\r\n  if (!clasesData || clasesData.length === 0) return [];\r\n\r\n  // Obtener materias por separado\r\n  const materiaIds = Array.from(\r\n    new Set(\r\n      clasesData\r\n        .map(clase => clase.materia_id)\r\n        .filter((id): id is number => id !== undefined && id !== null)\r\n    )\r\n  );\r\n\r\n  let materiasData: any[] = [];\r\n  if (materiaIds.length > 0) {\r\n    const { data, error: materiasError } = await supabase\r\n      .from('materias')\r\n      .select('id, nombre, codigo')\r\n      .in('id', materiaIds);\r\n\r\n    if (materiasError) throw materiasError;\r\n    materiasData = data || [];\r\n  }\r\n\r\n  // Combinar datos\r\n  return clasesData.map(clase => ({\r\n    ...clase,\r\n    materia: materiasData.find(m => m.id === clase.materia_id) || null\r\n  }));\r\n};\r\n\r\n// crear clase\r\nexport const createClase = async (\r\n  clase: Omit<Clase, 'id' | 'created_at' | 'updated_at'>\r\n): Promise<Clase> => {\r\n  const { data, error } = await supabase\r\n    .from('clases')\r\n    .insert({\r\n      materia_id: clase.materia_id,\r\n      docente_id: clase.docente_id,\r\n      grado: clase.grado,\r\n      seccion: clase.seccion,\r\n      horario: clase.horario,\r\n      aula: clase.aula,\r\n      periodo: clase.periodo,\r\n      estado: clase.estado || 'activo',\r\n    })\r\n    .select()\r\n    .single();\r\n\r\n  if (error) throw error;\r\n  return data;\r\n};\r\n\r\n// actualizar clase\r\nexport const updateClase = async (\r\n  id: string,\r\n  clase: Partial<Omit<Clase, 'id' | 'created_at' | 'updated_at'>>\r\n): Promise<Clase> => {\r\n  const { data, error } = await supabase\r\n    .from('clases')\r\n    .update(clase)\r\n    .eq('id', id)\r\n    .select()\r\n    .single();\r\n\r\n  if (error) throw error;\r\n  return data;\r\n};\r\n\r\n// eliminar clase\r\nexport const deleteClase = async (id: string): Promise<void> => {\r\n  const { error } = await supabase\r\n    .from('clases')\r\n    .delete()\r\n    .eq('id', id);\r\n\r\n  if (error) throw error;\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}