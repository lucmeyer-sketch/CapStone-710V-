{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\diego\\\\OneDrive\\\\Escritorio\\\\ProyectoAPT\\\\CapStone-710V-\\\\Proyecto\\\\src\\\\components\\\\Messages\\\\MessagingSystem.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { supabase } from '../../supabaseClient';\nimport { crearMensaje, getConversaciones, getConversacionesEstudiante, getMensajesPorEstudiante, getMensajesConversacionPrivada, marcarConversacionLeida, getEstadisticasMensajes } from '../../services/mensajeService';\nimport { useNotification } from '../../hooks/useNotification';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RESPUESTAS_RAPIDAS = ['Â¡Excelente trabajo! Sigue asÃ­ ðŸ‘', 'Necesitamos hablar sobre tu rendimiento acadÃ©mico', 'Por favor, entrega las tareas pendientes', 'Felicitaciones por tu dedicaciÃ³n ðŸŽ‰', 'Tu tutor debe comunicarse conmigo', 'Recuerda asistir a clases puntualmente'];\nconst MessagingSystem = ({\n  usuarioActual\n}) => {\n  _s();\n  var _usuarioActual$detall, _usuarioActual$detall2;\n  const {\n    showNotification,\n    NotificationContainer\n  } = useNotification();\n  const [conversaciones, setConversaciones] = useState([]);\n  const [conversacionesEstudiante, setConversacionesEstudiante] = useState([]);\n  const [conversacionActiva, setConversacionActiva] = useState(null);\n  const [mensajesActivos, setMensajesActivos] = useState([]);\n  const [estudiantes, setEstudiantes] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [busqueda, setBusqueda] = useState('');\n  const [mostrarNuevoMensaje, setMostrarNuevoMensaje] = useState(false);\n  const [mostrarRespuesta, setMostrarRespuesta] = useState(false);\n  const [mensajeAResponder, setMensajeAResponder] = useState(null);\n  const [estadisticas, setEstadisticas] = useState({\n    total: 0,\n    noLeidos: 0,\n    leidos: 0,\n    porTipo: {\n      general: 0,\n      urgente: 0,\n      academico: 0,\n      conductual: 0,\n      felicitacion: 0\n    }\n  });\n\n  // formulario de mensaje\n  const [formMensaje, setFormMensaje] = useState({\n    estudiante_id: '',\n    asunto: '',\n    mensaje: '',\n    tipo: 'general',\n    destinatario_tipo: 'tutor'\n  });\n  const chatEndRef = useRef(null);\n\n  // determinar ID y rol del usuario actual\n  const esDocente = usuarioActual.rol === 'docente';\n  const esEstudiante = usuarioActual.rol === 'estudiante';\n\n  // Para docentes: ID de docentes, Para estudiantes: ID de Estudiantes\n  const usuarioId = ((_usuarioActual$detall = usuarioActual.detalles) === null || _usuarioActual$detall === void 0 ? void 0 : _usuarioActual$detall.id) || 1;\n  const estudianteId = esEstudiante ? (_usuarioActual$detall2 = usuarioActual.detalles) === null || _usuarioActual$detall2 === void 0 ? void 0 : _usuarioActual$detall2.id : null;\n  useEffect(() => {\n    cargarDatos();\n  }, []);\n  useEffect(() => {\n    if (conversacionActiva) {\n      cargarMensajesEstudiante(conversacionActiva);\n    }\n  }, [conversacionActiva]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [mensajesActivos]);\n  const scrollToBottom = () => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const cargarDatos = async () => {\n    try {\n      setLoading(true);\n\n      // cargar estudiantes\n      const {\n        data: estudiantesData,\n        error: estudiantesError\n      } = await supabase.from('Estudiantes').select('id, nombre, apellido, grado, seccion, email').order('apellido', {\n        ascending: true\n      });\n      if (estudiantesError) throw estudiantesError;\n      setEstudiantes(estudiantesData || []);\n\n      // cargar conversaciones (solo para docentes)\n      if (esDocente) {\n        const conversacionesData = await getConversaciones(usuarioId);\n        setConversaciones(conversacionesData);\n\n        // cargar estadÃ­sticas\n        const stats = await getEstadisticasMensajes(usuarioId);\n        setEstadisticas(stats);\n      } else if (esEstudiante && estudianteId) {\n        // para estudiantes, cargar sus conversaciones agrupadas por docente\n        const conversacionesData = await getConversacionesEstudiante(estudianteId);\n        setConversacionesEstudiante(conversacionesData);\n\n        // obtener todos los mensajes para las estadÃ­sticas\n        const mensajesEstudiante = await getMensajesPorEstudiante(estudianteId);\n\n        // actualizar estadÃ­sticas para estudiantes\n        setEstadisticas({\n          total: mensajesEstudiante.length,\n          noLeidos: mensajesEstudiante.filter(m => !m.leido && m.destinatario_tipo === 'estudiante').length,\n          leidos: mensajesEstudiante.filter(m => m.leido || m.remitente_tipo === 'estudiante').length,\n          porTipo: {\n            general: mensajesEstudiante.filter(m => m.tipo === 'general').length,\n            urgente: mensajesEstudiante.filter(m => m.tipo === 'urgente').length,\n            academico: mensajesEstudiante.filter(m => m.tipo === 'academico').length,\n            conductual: mensajesEstudiante.filter(m => m.tipo === 'conductual').length,\n            felicitacion: mensajesEstudiante.filter(m => m.tipo === 'felicitacion').length\n          }\n        });\n      }\n      setError(null);\n    } catch (err) {\n      setError('Error al cargar datos: ' + err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const cargarMensajesEstudiante = async idConversacion => {\n    try {\n      let mensajes = [];\n      if (esDocente) {\n        // Docente viendo conversaciÃ³n con un estudiante\n        mensajes = await getMensajesConversacionPrivada(usuarioId, idConversacion);\n        // Marcar como leÃ­dos los mensajes de esta conversaciÃ³n\n        await marcarConversacionLeida(idConversacion, usuarioId);\n      } else if (esEstudiante && estudianteId) {\n        // Estudiante viendo conversaciÃ³n con un docente\n        // idConversacion es el ID del docente\n        mensajes = await getMensajesConversacionPrivada(idConversacion, estudianteId);\n        // Marcar como leÃ­dos los mensajes del docente\n        await marcarConversacionLeida(estudianteId, idConversacion);\n      }\n      setMensajesActivos(mensajes);\n\n      // actualizar conversaciones\n      cargarDatos();\n    } catch (err) {\n      setError('Error al cargar mensajes: ' + err.message);\n    }\n  };\n  const handleEnviarMensaje = async e => {\n    e.preventDefault();\n    if (!formMensaje.estudiante_id || !formMensaje.asunto || !formMensaje.mensaje) {\n      setError('Por favor completa todos los campos obligatorios');\n      return;\n    }\n    try {\n      setLoading(true);\n      await crearMensaje({\n        remitente_tipo: usuarioActual.rol,\n        remitente_id: usuarioId,\n        destinatario_tipo: formMensaje.destinatario_tipo,\n        destinatario_id: undefined,\n        // se enviarÃ­a al tutor o estudiante segÃºn el caso\n        estudiante_id: parseInt(formMensaje.estudiante_id),\n        asunto: formMensaje.asunto,\n        mensaje: formMensaje.mensaje,\n        tipo: formMensaje.tipo,\n        leido: false\n      });\n      showNotification('Mensaje enviado correctamente', 'success');\n      setFormMensaje({\n        estudiante_id: '',\n        asunto: '',\n        mensaje: '',\n        tipo: 'general',\n        destinatario_tipo: 'tutor'\n      });\n      setMostrarNuevoMensaje(false);\n      cargarDatos();\n\n      // si estamos en la conversaciÃ³n de este estudiante, recargar mensajes\n      if (conversacionActiva === parseInt(formMensaje.estudiante_id)) {\n        cargarMensajesEstudiante(conversacionActiva);\n      }\n    } catch (err) {\n      const errorMessage = err.message || 'Error desconocido';\n      setError('Error al enviar mensaje: ' + errorMessage);\n      showNotification('Error al enviar mensaje: ' + errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleRespuestaRapida = respuesta => {\n    setFormMensaje({\n      ...formMensaje,\n      mensaje: respuesta\n    });\n  };\n  const handleResponder = mensaje => {\n    setMensajeAResponder(mensaje);\n    setMostrarRespuesta(true);\n  };\n  const handleEnviarRespuesta = async e => {\n    e.preventDefault();\n    if (!formMensaje.mensaje) {\n      setError('Por favor escribe tu respuesta');\n      return;\n    }\n    if (!mensajeAResponder) {\n      setError('No hay mensaje para responder');\n      return;\n    }\n    try {\n      setLoading(true);\n\n      // Para estudiantes que responden: el docente es el destinatario\n      // Necesitamos obtener el ID del docente que enviÃ³ el mensaje original\n      await crearMensaje({\n        remitente_tipo: 'estudiante',\n        // El estudiante responde\n        remitente_id: usuarioId,\n        // ID del estudiante en la tabla usuarios\n        destinatario_tipo: 'docente',\n        // Al docente\n        destinatario_id: mensajeAResponder.remitente_id,\n        // ID del docente que enviÃ³ el mensaje\n        estudiante_id: estudianteId,\n        // ID del estudiante\n        asunto: `RE: ${mensajeAResponder.asunto}`,\n        mensaje: formMensaje.mensaje,\n        tipo: formMensaje.tipo,\n        leido: false\n      });\n      showNotification('Respuesta enviada correctamente', 'success');\n      setFormMensaje({\n        estudiante_id: '',\n        asunto: '',\n        mensaje: '',\n        tipo: 'general',\n        destinatario_tipo: 'docente'\n      });\n      setMostrarRespuesta(false);\n      setMensajeAResponder(null);\n\n      // Recargar mensajes de la conversaciÃ³n activa\n      if (conversacionActiva) {\n        await cargarMensajesEstudiante(conversacionActiva);\n      }\n    } catch (err) {\n      const errorMessage = err.message || 'Error desconocido';\n      setError('Error al enviar respuesta: ' + errorMessage);\n      showNotification('Error al enviar respuesta: ' + errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const getTipoColor = tipo => {\n    switch (tipo) {\n      case 'urgente':\n        return {\n          bg: '#fee2e2',\n          text: '#991b1b',\n          icon: 'ðŸš¨'\n        };\n      case 'academico':\n        return {\n          bg: '#dbeafe',\n          text: '#1e40af',\n          icon: 'ðŸ“š'\n        };\n      case 'conductual':\n        return {\n          bg: '#fef3c7',\n          text: '#92400e',\n          icon: 'âš ï¸'\n        };\n      case 'felicitacion':\n        return {\n          bg: '#dcfce7',\n          text: '#166534',\n          icon: 'ðŸŽ‰'\n        };\n      default:\n        return {\n          bg: '#f3f4f6',\n          text: '#374151',\n          icon: 'ðŸ’¬'\n        };\n    }\n  };\n  const getTipoBadge = tipo => {\n    const colores = getTipoColor(tipo);\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        backgroundColor: colores.bg,\n        color: colores.text,\n        padding: '4px 10px',\n        borderRadius: '12px',\n        fontSize: '11px',\n        fontWeight: '600',\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: '4px'\n      },\n      children: [colores.icon, \" \", tipo.toUpperCase()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }, this);\n  };\n  const estudiantesFiltrados = estudiantes.filter(est => {\n    var _est$email;\n    return `${est.nombre} ${est.apellido}`.toLowerCase().includes(busqueda.toLowerCase()) || ((_est$email = est.email) === null || _est$email === void 0 ? void 0 : _est$email.toLowerCase().includes(busqueda.toLowerCase()));\n  });\n\n  // filtrar conversaciones segÃºn el rol\n  const conversacionesFiltradas = esDocente ? conversaciones.filter(conv => `${conv.estudiante_nombre} ${conv.estudiante_apellido}`.toLowerCase().includes(busqueda.toLowerCase())) : conversacionesEstudiante.filter(conv => `${conv.docente_nombre} ${conv.docente_apellido}`.toLowerCase().includes(busqueda.toLowerCase()));\n  const estudianteActivo = conversacionActiva && esDocente ? conversaciones.find(c => c.estudiante_id === conversacionActiva) : null;\n  const docenteActivo = conversacionActiva && esEstudiante ? conversacionesEstudiante.find(c => c.docente_id === conversacionActiva) : null;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(NotificationContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 'calc(100vh - 80px)',\n        display: 'flex',\n        flexDirection: 'column',\n        backgroundColor: '#f9fafb'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '20px',\n          backgroundColor: 'white',\n          borderBottom: '1px solid #e5e7eb'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          style: {\n            fontSize: '28px',\n            fontWeight: '700',\n            color: '#1a1a1a',\n            marginBottom: '16px'\n          },\n          children: [\"\\uD83D\\uDCAC \", esEstudiante ? 'Mis Mensajes' : 'Sistema de MensajerÃ­a']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 9\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '12px 16px',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #fecaca',\n            color: '#b91c1c',\n            borderRadius: '8px',\n            marginBottom: '16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u26A0\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setError(null),\n            style: {\n              marginLeft: 'auto',\n              background: 'none',\n              border: 'none',\n              fontSize: '18px',\n              cursor: 'pointer',\n              color: '#b91c1c'\n            },\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'grid',\n            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',\n            gap: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: '#ede9fe',\n              padding: '16px',\n              borderRadius: '10px',\n              border: '1px solid #ddd6fe'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '24px',\n                fontWeight: '700',\n                color: '#7c3aed'\n              },\n              children: estadisticas.total\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                color: '#6d28d9',\n                fontWeight: '500'\n              },\n              children: \"Total Mensajes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: '#dbeafe',\n              padding: '16px',\n              borderRadius: '10px',\n              border: '1px solid #bfdbfe'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '24px',\n                fontWeight: '700',\n                color: '#2563eb'\n              },\n              children: conversaciones.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                color: '#1d4ed8',\n                fontWeight: '500'\n              },\n              children: \"Conversaciones\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: '#fef3c7',\n              padding: '16px',\n              borderRadius: '10px',\n              border: '1px solid #fde68a'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '24px',\n                fontWeight: '700',\n                color: '#d97706'\n              },\n              children: estadisticas.noLeidos\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                color: '#b45309',\n                fontWeight: '500'\n              },\n              children: \"Sin Leer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: '#dcfce7',\n              padding: '16px',\n              borderRadius: '10px',\n              border: '1px solid #a7f3d0'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '24px',\n                fontWeight: '700',\n                color: '#059669'\n              },\n              children: estadisticas.leidos\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                color: '#047857',\n                fontWeight: '500'\n              },\n              children: \"Le\\xEDdos\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          display: 'flex',\n          overflow: 'hidden'\n        },\n        children: [(esDocente || esEstudiante) && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '350px',\n            backgroundColor: 'white',\n            borderRight: '1px solid #e5e7eb',\n            display: 'flex',\n            flexDirection: 'column'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: '16px',\n              borderBottom: '1px solid #e5e7eb'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: esDocente ? '12px' : '0'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"\\uD83D\\uDD0D Buscar conversaci\\xF3n...\",\n                value: busqueda,\n                onChange: e => setBusqueda(e.target.value),\n                style: {\n                  width: '100%',\n                  padding: '10px 12px',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '8px',\n                  fontSize: '14px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 434,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 13\n            }, this), esDocente && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setMostrarNuevoMensaje(true),\n              style: {\n                width: '100%',\n                backgroundColor: '#3b82f6',\n                color: 'white',\n                padding: '10px',\n                borderRadius: '8px',\n                border: 'none',\n                fontSize: '14px',\n                fontWeight: '600',\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                gap: '8px'\n              },\n              children: \"\\u270F\\uFE0F Nuevo Mensaje\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 449,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              overflowY: 'auto'\n            },\n            children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '40px',\n                textAlign: 'center',\n                color: '#9ca3af'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '32px',\n                  marginBottom: '12px'\n                },\n                children: \"\\u23F3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Cargando...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 15\n            }, this) : conversacionesFiltradas.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '40px',\n                textAlign: 'center',\n                color: '#9ca3af'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '48px',\n                  marginBottom: '12px'\n                },\n                children: \"\\uD83D\\uDCED\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                style: {\n                  fontSize: '14px'\n                },\n                children: \"No hay conversaciones\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this) : esDocente ?\n            // Vista de conversaciones para docentes\n            conversacionesFiltradas.map(conv => /*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => setConversacionActiva(conv.estudiante_id),\n              style: {\n                padding: '16px',\n                borderBottom: '1px solid #f3f4f6',\n                cursor: 'pointer',\n                backgroundColor: conversacionActiva === conv.estudiante_id ? '#f0f9ff' : 'white',\n                transition: 'background-color 0.2s'\n              },\n              onMouseOver: e => {\n                if (conversacionActiva !== conv.estudiante_id) {\n                  e.currentTarget.style.backgroundColor = '#f9fafb';\n                }\n              },\n              onMouseOut: e => {\n                if (conversacionActiva !== conv.estudiante_id) {\n                  e.currentTarget.style.backgroundColor = 'white';\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '12px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '48px',\n                    height: '48px',\n                    borderRadius: '50%',\n                    backgroundColor: '#e0e7ff',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '20px',\n                    fontWeight: '600',\n                    color: '#4f46e5',\n                    flexShrink: 0\n                  },\n                  children: [conv.estudiante_nombre.charAt(0), conv.estudiante_apellido.charAt(0)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 509,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    flex: 1,\n                    minWidth: 0\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center',\n                      marginBottom: '4px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontWeight: '600',\n                        color: '#1f2937',\n                        fontSize: '14px'\n                      },\n                      children: [conv.estudiante_apellido, \" \", conv.estudiante_nombre]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 526,\n                      columnNumber: 25\n                    }, this), conv.mensajes_no_leidos > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        backgroundColor: '#3b82f6',\n                        color: 'white',\n                        borderRadius: '12px',\n                        padding: '2px 8px',\n                        fontSize: '11px',\n                        fontWeight: '700'\n                      },\n                      children: conv.mensajes_no_leidos\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 530,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 525,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '11px',\n                      color: '#9ca3af',\n                      marginBottom: '4px'\n                    },\n                    children: [conv.estudiante_grado, conv.estudiante_seccion]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 542,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '13px',\n                      color: '#6b7280',\n                      whiteSpace: 'nowrap',\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis'\n                    },\n                    children: conv.ultimo_mensaje\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 545,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginTop: '4px'\n                    },\n                    children: getTipoBadge(conv.ultimo_mensaje_tipo)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 554,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 524,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 508,\n                columnNumber: 19\n              }, this)\n            }, conv.estudiante_id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 17\n            }, this)) :\n            // Vista de conversaciones para estudiantes\n            conversacionesFiltradas.map(conv => /*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => setConversacionActiva(conv.docente_id),\n              style: {\n                padding: '16px',\n                borderBottom: '1px solid #f3f4f6',\n                cursor: 'pointer',\n                backgroundColor: conversacionActiva === conv.docente_id ? '#f0f9ff' : 'white',\n                transition: 'background-color 0.2s'\n              },\n              onMouseOver: e => {\n                if (conversacionActiva !== conv.docente_id) {\n                  e.currentTarget.style.backgroundColor = '#f9fafb';\n                }\n              },\n              onMouseOut: e => {\n                if (conversacionActiva !== conv.docente_id) {\n                  e.currentTarget.style.backgroundColor = 'white';\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '12px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '48px',\n                    height: '48px',\n                    borderRadius: '50%',\n                    backgroundColor: '#fce7f3',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '20px',\n                    fontWeight: '600',\n                    color: '#be123c',\n                    flexShrink: 0\n                  },\n                  children: [conv.docente_nombre.charAt(0), conv.docente_apellido.charAt(0)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 586,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    flex: 1,\n                    minWidth: 0\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center',\n                      marginBottom: '4px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontWeight: '600',\n                        color: '#1f2937',\n                        fontSize: '14px'\n                      },\n                      children: [\"Prof. \", conv.docente_apellido, \" \", conv.docente_nombre]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 603,\n                      columnNumber: 25\n                    }, this), conv.mensajes_no_leidos > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        backgroundColor: '#ef4444',\n                        color: 'white',\n                        borderRadius: '12px',\n                        padding: '2px 8px',\n                        fontSize: '11px',\n                        fontWeight: '700'\n                      },\n                      children: conv.mensajes_no_leidos\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 607,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 602,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '11px',\n                      color: '#9ca3af',\n                      marginBottom: '4px'\n                    },\n                    children: conv.docente_especialidad || 'Docente'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 619,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '13px',\n                      color: '#6b7280',\n                      whiteSpace: 'nowrap',\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis'\n                    },\n                    children: conv.ultimo_mensaje\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 622,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginTop: '4px'\n                    },\n                    children: getTipoBadge(conv.ultimo_mensaje_tipo)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 631,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 601,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 585,\n                columnNumber: 19\n              }, this)\n            }, conv.docente_id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            flex: 1,\n            display: 'flex',\n            flexDirection: 'column',\n            backgroundColor: '#f9fafb'\n          },\n          children: mostrarRespuesta && esEstudiante ?\n          /*#__PURE__*/\n          // Formulario de respuesta para estudiantes\n          _jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              padding: '24px',\n              overflowY: 'auto'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maxWidth: '700px',\n                margin: '0 auto'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  backgroundColor: 'white',\n                  borderRadius: '12px',\n                  padding: '24px',\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\n                  border: '1px solid #e5e7eb'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    marginBottom: '24px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                    style: {\n                      fontSize: '20px',\n                      fontWeight: '600',\n                      color: '#374151'\n                    },\n                    children: \"\\u21A9\\uFE0F Responder Mensaje\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 657,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      setMostrarRespuesta(false);\n                      setMensajeAResponder(null);\n                    },\n                    style: {\n                      background: 'none',\n                      border: 'none',\n                      fontSize: '24px',\n                      cursor: 'pointer',\n                      color: '#9ca3af'\n                    },\n                    children: \"\\u2715\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 660,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 656,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    backgroundColor: '#f9fafb',\n                    padding: '16px',\n                    borderRadius: '8px',\n                    marginBottom: '24px',\n                    borderLeft: '4px solid #3b82f6'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '12px',\n                      color: '#6b7280',\n                      marginBottom: '8px'\n                    },\n                    children: \"Mensaje original de tu profesor:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 685,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: '600',\n                      fontSize: '14px',\n                      marginBottom: '4px'\n                    },\n                    children: mensajeAResponder === null || mensajeAResponder === void 0 ? void 0 : mensajeAResponder.asunto\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 688,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '14px',\n                      color: '#374151'\n                    },\n                    children: mensajeAResponder === null || mensajeAResponder === void 0 ? void 0 : mensajeAResponder.mensaje\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 691,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 678,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: handleEnviarRespuesta,\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: labelStyle,\n                      children: \"Tipo de Mensaje\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 698,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: formMensaje.tipo,\n                      onChange: e => setFormMensaje({\n                        ...formMensaje,\n                        tipo: e.target.value\n                      }),\n                      style: inputStyle,\n                      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"general\",\n                        children: \"\\uD83D\\uDCAC General\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 704,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"academico\",\n                        children: \"\\uD83D\\uDCDA Acad\\xE9mico\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 705,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"conductual\",\n                        children: \"\\u26A0\\uFE0F Conductual\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 706,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 699,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 697,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: labelStyle,\n                      children: \"Tu Respuesta *\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 711,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      value: formMensaje.mensaje,\n                      onChange: e => setFormMensaje({\n                        ...formMensaje,\n                        mensaje: e.target.value\n                      }),\n                      style: {\n                        ...inputStyle,\n                        minHeight: '150px',\n                        resize: 'vertical'\n                      },\n                      placeholder: \"Escribe tu respuesta aqu\\xED...\",\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 712,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 710,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      gap: '12px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"submit\",\n                      disabled: loading,\n                      style: {\n                        flex: 1,\n                        backgroundColor: loading ? '#9ca3af' : '#10b981',\n                        color: 'white',\n                        padding: '12px',\n                        borderRadius: '8px',\n                        border: 'none',\n                        fontSize: '15px',\n                        fontWeight: '600',\n                        cursor: loading ? 'not-allowed' : 'pointer'\n                      },\n                      children: loading ? 'â³ Enviando...' : 'ðŸ“¤ Enviar Respuesta'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 722,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => {\n                        setMostrarRespuesta(false);\n                        setMensajeAResponder(null);\n                      },\n                      style: {\n                        backgroundColor: '#6b7280',\n                        color: 'white',\n                        padding: '12px 24px',\n                        borderRadius: '8px',\n                        border: 'none',\n                        fontSize: '15px',\n                        fontWeight: '600',\n                        cursor: 'pointer'\n                      },\n                      children: \"Cancelar\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 740,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 721,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 696,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 649,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 13\n          }, this) : mostrarNuevoMensaje ?\n          /*#__PURE__*/\n          // Formulario nuevo mensaje\n          _jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              padding: '24px',\n              overflowY: 'auto'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maxWidth: '700px',\n                margin: '0 auto'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  backgroundColor: 'white',\n                  borderRadius: '12px',\n                  padding: '24px',\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\n                  border: '1px solid #e5e7eb'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    marginBottom: '24px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                    style: {\n                      fontSize: '20px',\n                      fontWeight: '600',\n                      color: '#374151'\n                    },\n                    children: \"\\u270F\\uFE0F Nuevo Mensaje\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 776,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setMostrarNuevoMensaje(false),\n                    style: {\n                      background: 'none',\n                      border: 'none',\n                      fontSize: '24px',\n                      cursor: 'pointer',\n                      color: '#9ca3af'\n                    },\n                    children: \"\\u2715\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 779,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 775,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: handleEnviarMensaje,\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: labelStyle,\n                      children: \"Estudiante *\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 795,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: formMensaje.estudiante_id,\n                      onChange: e => setFormMensaje({\n                        ...formMensaje,\n                        estudiante_id: e.target.value\n                      }),\n                      style: inputStyle,\n                      required: true,\n                      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"\",\n                        children: \"Seleccionar estudiante\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 802,\n                        columnNumber: 25\n                      }, this), estudiantesFiltrados.map(est => /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: est.id,\n                        children: [est.apellido, \" \", est.nombre, \" - \", est.grado, est.seccion]\n                      }, est.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 804,\n                        columnNumber: 27\n                      }, this))]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 796,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 794,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'grid',\n                      gridTemplateColumns: '1fr 1fr',\n                      gap: '16px',\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        style: labelStyle,\n                        children: \"Destinatario *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 813,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                        value: formMensaje.destinatario_tipo,\n                        onChange: e => setFormMensaje({\n                          ...formMensaje,\n                          destinatario_tipo: e.target.value\n                        }),\n                        style: inputStyle,\n                        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"tutor\",\n                          children: \"\\uD83D\\uDC68\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC66 Tutor/Apoderado\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 819,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"estudiante\",\n                          children: \"\\uD83C\\uDF93 Estudiante\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 820,\n                          columnNumber: 27\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 814,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 812,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        style: labelStyle,\n                        children: \"Tipo de Mensaje *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 825,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                        value: formMensaje.tipo,\n                        onChange: e => setFormMensaje({\n                          ...formMensaje,\n                          tipo: e.target.value\n                        }),\n                        style: inputStyle,\n                        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"general\",\n                          children: \"\\uD83D\\uDCAC General\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 831,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"academico\",\n                          children: \"\\uD83D\\uDCDA Acad\\xE9mico\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 832,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"conductual\",\n                          children: \"\\u26A0\\uFE0F Conductual\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 833,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"urgente\",\n                          children: \"\\uD83D\\uDEA8 Urgente\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 834,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"felicitacion\",\n                          children: \"\\uD83C\\uDF89 Felicitaci\\xF3n\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 835,\n                          columnNumber: 27\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 826,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 824,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 811,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: labelStyle,\n                      children: \"Asunto *\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 841,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: formMensaje.asunto,\n                      onChange: e => setFormMensaje({\n                        ...formMensaje,\n                        asunto: e.target.value\n                      }),\n                      style: inputStyle,\n                      placeholder: \"Ej: Revisi\\xF3n de calificaciones\",\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 842,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 840,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '16px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: labelStyle,\n                      children: \"Mensaje *\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 853,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      value: formMensaje.mensaje,\n                      onChange: e => setFormMensaje({\n                        ...formMensaje,\n                        mensaje: e.target.value\n                      }),\n                      style: {\n                        ...inputStyle,\n                        minHeight: '120px',\n                        resize: 'vertical'\n                      },\n                      placeholder: \"Escribe tu mensaje aqu\\xED...\",\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 854,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 852,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginBottom: '20px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: {\n                        ...labelStyle,\n                        marginBottom: '8px'\n                      },\n                      children: \"\\u26A1 Respuestas R\\xE1pidas:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 865,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex',\n                        flexWrap: 'wrap',\n                        gap: '8px'\n                      },\n                      children: RESPUESTAS_RAPIDAS.map((respuesta, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n                        type: \"button\",\n                        onClick: () => handleRespuestaRapida(respuesta),\n                        style: {\n                          backgroundColor: '#f3f4f6',\n                          border: '1px solid #d1d5db',\n                          padding: '6px 12px',\n                          borderRadius: '16px',\n                          fontSize: '12px',\n                          cursor: 'pointer',\n                          transition: 'all 0.2s'\n                        },\n                        onMouseOver: e => {\n                          e.currentTarget.style.backgroundColor = '#e5e7eb';\n                          e.currentTarget.style.borderColor = '#9ca3af';\n                        },\n                        onMouseOut: e => {\n                          e.currentTarget.style.backgroundColor = '#f3f4f6';\n                          e.currentTarget.style.borderColor = '#d1d5db';\n                        },\n                        children: respuesta\n                      }, idx, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 868,\n                        columnNumber: 27\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 866,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 864,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      gap: '12px'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"submit\",\n                      disabled: loading,\n                      style: {\n                        flex: 1,\n                        backgroundColor: loading ? '#9ca3af' : '#10b981',\n                        color: 'white',\n                        padding: '12px',\n                        borderRadius: '8px',\n                        border: 'none',\n                        fontSize: '15px',\n                        fontWeight: '600',\n                        cursor: loading ? 'not-allowed' : 'pointer'\n                      },\n                      children: loading ? 'â³ Enviando...' : 'ðŸ“¤ Enviar Mensaje'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 897,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => setMostrarNuevoMensaje(false),\n                      style: {\n                        backgroundColor: '#6b7280',\n                        color: 'white',\n                        padding: '12px 24px',\n                        borderRadius: '8px',\n                        border: 'none',\n                        fontSize: '15px',\n                        fontWeight: '600',\n                        cursor: 'pointer'\n                      },\n                      children: \"Cancelar\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 915,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 896,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 793,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 768,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 767,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 766,\n            columnNumber: 13\n          }, this) : esDocente && conversacionActiva && estudianteActivo || esEstudiante && conversacionActiva && docenteActivo ?\n          /*#__PURE__*/\n          // Vista de chat\n          _jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                backgroundColor: 'white',\n                padding: '16px 24px',\n                borderBottom: '1px solid #e5e7eb',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '12px'\n              },\n              children: esDocente && estudianteActivo ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '48px',\n                    height: '48px',\n                    borderRadius: '50%',\n                    backgroundColor: '#e0e7ff',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '20px',\n                    fontWeight: '600',\n                    color: '#4f46e5'\n                  },\n                  children: [estudianteActivo.estudiante_nombre.charAt(0), estudianteActivo.estudiante_apellido.charAt(0)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 950,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    flex: 1\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: '600',\n                      fontSize: '16px',\n                      color: '#1f2937'\n                    },\n                    children: [estudianteActivo.estudiante_apellido, \" \", estudianteActivo.estudiante_nombre]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 965,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '13px',\n                      color: '#6b7280'\n                    },\n                    children: [estudianteActivo.estudiante_grado, estudianteActivo.estudiante_seccion, \" \\u2022 \", estudianteActivo.total_mensajes, \" mensajes\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 968,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 964,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setConversacionActiva(null),\n                  style: {\n                    background: 'none',\n                    border: 'none',\n                    fontSize: '24px',\n                    cursor: 'pointer',\n                    color: '#9ca3af'\n                  },\n                  children: \"\\u2715\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 972,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true) : esEstudiante && docenteActivo ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '48px',\n                    height: '48px',\n                    borderRadius: '50%',\n                    backgroundColor: '#fce7f3',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '20px',\n                    fontWeight: '600',\n                    color: '#be123c'\n                  },\n                  children: [docenteActivo.docente_nombre.charAt(0), docenteActivo.docente_apellido.charAt(0)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 987,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    flex: 1\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: '600',\n                      fontSize: '16px',\n                      color: '#1f2937'\n                    },\n                    children: [\"Prof. \", docenteActivo.docente_apellido, \" \", docenteActivo.docente_nombre]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1002,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '13px',\n                      color: '#6b7280'\n                    },\n                    children: [docenteActivo.docente_especialidad || 'Docente', \" \\u2022 \", docenteActivo.total_mensajes, \" mensajes\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1005,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1001,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setConversacionActiva(null),\n                  style: {\n                    background: 'none',\n                    border: 'none',\n                    fontSize: '24px',\n                    cursor: 'pointer',\n                    color: '#9ca3af'\n                  },\n                  children: \"\\u2715\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1009,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true) : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 940,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                flex: 1,\n                overflowY: 'auto',\n                padding: '24px',\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '16px'\n              },\n              children: [mensajesActivos.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  textAlign: 'center',\n                  padding: '60px 20px',\n                  color: '#9ca3af'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: '64px',\n                    marginBottom: '16px'\n                  },\n                  children: \"\\uD83D\\uDCAC\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1036,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    fontSize: '16px',\n                    fontWeight: '500',\n                    color: '#6b7280'\n                  },\n                  children: \"No hay mensajes en esta conversaci\\xF3n\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1037,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    fontSize: '14px',\n                    marginTop: '8px'\n                  },\n                  children: \"\\xA1Env\\xEDa el primer mensaje!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1040,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1035,\n                columnNumber: 19\n              }, this) : mensajesActivos.map(mensaje => {\n                var _mensaje$docente, _mensaje$estudiante, _mensaje$docente2, _mensaje$docente3, _mensaje$estudiante2, _mensaje$estudiante3;\n                // determinar si el mensaje es del usuario actual\n                const esMioElMensaje = esEstudiante && mensaje.remitente_tipo === 'estudiante' && mensaje.remitente_id === usuarioId || esDocente && mensaje.remitente_tipo === 'docente' && mensaje.remitente_id === usuarioId;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    justifyContent: esMioElMensaje ? 'flex-end' : 'flex-start',\n                    marginBottom: '12px'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      maxWidth: '70%',\n                      backgroundColor: esMioElMensaje ? '#10b981' : '#3b82f6',\n                      color: 'white',\n                      padding: '12px 16px',\n                      borderRadius: esMioElMensaje ? '16px 16px 4px 16px' : '16px 16px 16px 4px',\n                      boxShadow: `0 2px 4px rgba(${esMioElMensaje ? '16, 185, 129' : '59, 130, 246'}, 0.3)`\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '8px',\n                        marginBottom: '8px',\n                        flexWrap: 'wrap'\n                      },\n                      children: [getTipoBadge(mensaje.tipo || 'general'), /*#__PURE__*/_jsxDEV(\"span\", {\n                        style: {\n                          fontSize: '11px',\n                          opacity: 0.9\n                        },\n                        children: esMioElMensaje ? esEstudiante ? `TÃº â†’ Profesor ${((_mensaje$docente = mensaje.docente) === null || _mensaje$docente === void 0 ? void 0 : _mensaje$docente.apellido) || ''}` : `TÃº â†’ ${((_mensaje$estudiante = mensaje.estudiante) === null || _mensaje$estudiante === void 0 ? void 0 : _mensaje$estudiante.apellido) || 'estudiante'}` : esEstudiante ? `De: Prof. ${(_mensaje$docente2 = mensaje.docente) === null || _mensaje$docente2 === void 0 ? void 0 : _mensaje$docente2.nombre} ${(_mensaje$docente3 = mensaje.docente) === null || _mensaje$docente3 === void 0 ? void 0 : _mensaje$docente3.apellido}` : `Respuesta de: ${(_mensaje$estudiante2 = mensaje.estudiante) === null || _mensaje$estudiante2 === void 0 ? void 0 : _mensaje$estudiante2.nombre} ${(_mensaje$estudiante3 = mensaje.estudiante) === null || _mensaje$estudiante3 === void 0 ? void 0 : _mensaje$estudiante3.apellido}`\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1076,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1074,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontWeight: '600',\n                        fontSize: '14px',\n                        marginBottom: '8px'\n                      },\n                      children: mensaje.asunto\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1086,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: '14px',\n                        lineHeight: '1.5',\n                        marginBottom: '8px'\n                      },\n                      children: mensaje.mensaje\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1089,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        gap: '12px',\n                        flexWrap: 'wrap'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          fontSize: '11px',\n                          opacity: 0.8\n                        },\n                        children: [new Date(mensaje.created_at).toLocaleString('es-ES', {\n                          day: '2-digit',\n                          month: '2-digit',\n                          year: 'numeric',\n                          hour: '2-digit',\n                          minute: '2-digit'\n                        }), mensaje.leido && ' â€¢ âœ“âœ“']\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1099,\n                        columnNumber: 29\n                      }, this), esEstudiante && !esMioElMensaje && /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => handleResponder(mensaje),\n                        style: {\n                          backgroundColor: 'rgba(255, 255, 255, 0.2)',\n                          color: 'white',\n                          border: '1px solid rgba(255, 255, 255, 0.3)',\n                          padding: '4px 12px',\n                          borderRadius: '12px',\n                          fontSize: '12px',\n                          fontWeight: '600',\n                          cursor: 'pointer',\n                          transition: 'all 0.2s'\n                        },\n                        onMouseOver: e => e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.3)',\n                        onMouseOut: e => e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.2)',\n                        children: \"\\u21A9\\uFE0F Responder\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1110,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1092,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1066,\n                    columnNumber: 25\n                  }, this)\n                }, mensaje.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1058,\n                  columnNumber: 23\n                }, this);\n              }), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1135,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1026,\n              columnNumber: 15\n            }, this), esDocente && conversacionActiva && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                backgroundColor: 'white',\n                borderTop: '1px solid #e5e7eb',\n                padding: '16px 24px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  setFormMensaje({\n                    ...formMensaje,\n                    estudiante_id: conversacionActiva.toString()\n                  });\n                  setMostrarNuevoMensaje(true);\n                },\n                style: {\n                  width: '100%',\n                  backgroundColor: '#3b82f6',\n                  color: 'white',\n                  padding: '12px',\n                  borderRadius: '8px',\n                  border: 'none',\n                  fontSize: '14px',\n                  fontWeight: '600',\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: '8px'\n                },\n                children: \"\\u270F\\uFE0F Escribir Nuevo Mensaje\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1145,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1140,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true) :\n          /*#__PURE__*/\n          // Estado vacÃ­o\n          _jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              flexDirection: 'column',\n              color: '#9ca3af'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '96px',\n                marginBottom: '24px'\n              },\n              children: \"\\uD83D\\uDCAC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1184,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                fontSize: '20px',\n                fontWeight: '600',\n                color: '#6b7280',\n                marginBottom: '8px'\n              },\n              children: \"Selecciona una conversaci\\xF3n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1185,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                fontSize: '14px'\n              },\n              children: \"o crea un nuevo mensaje con el bot\\xF3n de arriba\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1188,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1176,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n_s(MessagingSystem, \"iXyYOo8Rmmo7RstsHHYve8d57f4=\", false, function () {\n  return [useNotification];\n});\n_c = MessagingSystem;\nconst labelStyle = {\n  display: 'block',\n  marginBottom: '8px',\n  fontWeight: '500',\n  fontSize: '14px',\n  color: '#374151'\n};\nconst inputStyle = {\n  width: '100%',\n  padding: '10px 12px',\n  border: '1px solid #d1d5db',\n  borderRadius: '8px',\n  fontSize: '14px',\n  outline: 'none'\n};\nexport default MessagingSystem;\nvar _c;\n$RefreshReg$(_c, \"MessagingSystem\");","map":{"version":3,"names":["React","useState","useEffect","useRef","supabase","crearMensaje","getConversaciones","getConversacionesEstudiante","getMensajesPorEstudiante","getMensajesConversacionPrivada","marcarConversacionLeida","getEstadisticasMensajes","useNotification","jsxDEV","_jsxDEV","Fragment","_Fragment","RESPUESTAS_RAPIDAS","MessagingSystem","usuarioActual","_s","_usuarioActual$detall","_usuarioActual$detall2","showNotification","NotificationContainer","conversaciones","setConversaciones","conversacionesEstudiante","setConversacionesEstudiante","conversacionActiva","setConversacionActiva","mensajesActivos","setMensajesActivos","estudiantes","setEstudiantes","loading","setLoading","error","setError","busqueda","setBusqueda","mostrarNuevoMensaje","setMostrarNuevoMensaje","mostrarRespuesta","setMostrarRespuesta","mensajeAResponder","setMensajeAResponder","estadisticas","setEstadisticas","total","noLeidos","leidos","porTipo","general","urgente","academico","conductual","felicitacion","formMensaje","setFormMensaje","estudiante_id","asunto","mensaje","tipo","destinatario_tipo","chatEndRef","esDocente","rol","esEstudiante","usuarioId","detalles","id","estudianteId","cargarDatos","cargarMensajesEstudiante","scrollToBottom","_chatEndRef$current","current","scrollIntoView","behavior","data","estudiantesData","estudiantesError","from","select","order","ascending","conversacionesData","stats","mensajesEstudiante","length","filter","m","leido","remitente_tipo","err","message","idConversacion","mensajes","handleEnviarMensaje","e","preventDefault","remitente_id","destinatario_id","undefined","parseInt","errorMessage","handleRespuestaRapida","respuesta","handleResponder","handleEnviarRespuesta","getTipoColor","bg","text","icon","getTipoBadge","colores","style","backgroundColor","color","padding","borderRadius","fontSize","fontWeight","display","alignItems","gap","children","toUpperCase","fileName","_jsxFileName","lineNumber","columnNumber","estudiantesFiltrados","est","_est$email","nombre","apellido","toLowerCase","includes","email","conversacionesFiltradas","conv","estudiante_nombre","estudiante_apellido","docente_nombre","docente_apellido","estudianteActivo","find","c","docenteActivo","docente_id","height","flexDirection","borderBottom","marginBottom","border","onClick","marginLeft","background","cursor","gridTemplateColumns","flex","overflow","width","borderRight","type","placeholder","value","onChange","target","justifyContent","overflowY","textAlign","map","transition","onMouseOver","currentTarget","onMouseOut","flexShrink","charAt","minWidth","mensajes_no_leidos","estudiante_grado","estudiante_seccion","whiteSpace","textOverflow","ultimo_mensaje","marginTop","ultimo_mensaje_tipo","docente_especialidad","maxWidth","margin","boxShadow","borderLeft","onSubmit","labelStyle","inputStyle","minHeight","resize","required","disabled","grado","seccion","flexWrap","idx","borderColor","total_mensajes","_mensaje$docente","_mensaje$estudiante","_mensaje$docente2","_mensaje$docente3","_mensaje$estudiante2","_mensaje$estudiante3","esMioElMensaje","opacity","docente","estudiante","lineHeight","Date","created_at","toLocaleString","day","month","year","hour","minute","ref","borderTop","toString","_c","outline","$RefreshReg$"],"sources":["C:/Users/diego/OneDrive/Escritorio/ProyectoAPT/CapStone-710V-/Proyecto/src/components/Messages/MessagingSystem.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { supabase } from '../../supabaseClient';\r\nimport {\r\n  crearMensaje,\r\n  getConversaciones,\r\n  getConversacionesEstudiante,\r\n  getMensajesPorEstudiante,\r\n  getMensajesConversacionPrivada,\r\n  marcarConversacionLeida,\r\n  getEstadisticasMensajes,\r\n  Conversacion,\r\n  ConversacionEstudiante,\r\n  MensajeConDetalles\r\n} from '../../services/mensajeService';\r\nimport { UsuarioConDetalles } from '../../services/authService';\r\nimport { useNotification } from '../../hooks/useNotification';\r\n\r\ninterface Estudiante {\r\n  id: number;\r\n  nombre: string;\r\n  apellido: string;\r\n  grado?: string;\r\n  seccion?: string;\r\n  email?: string;\r\n}\r\n\r\ninterface MessagingSystemProps {\r\n  usuarioActual: UsuarioConDetalles;\r\n}\r\n\r\nconst RESPUESTAS_RAPIDAS = [\r\n  'Â¡Excelente trabajo! Sigue asÃ­ ðŸ‘',\r\n  'Necesitamos hablar sobre tu rendimiento acadÃ©mico',\r\n  'Por favor, entrega las tareas pendientes',\r\n  'Felicitaciones por tu dedicaciÃ³n ðŸŽ‰',\r\n  'Tu tutor debe comunicarse conmigo',\r\n  'Recuerda asistir a clases puntualmente'\r\n];\r\n\r\nconst MessagingSystem: React.FC<MessagingSystemProps> = ({ usuarioActual }) => {\r\n  const { showNotification, NotificationContainer } = useNotification();\r\n  const [conversaciones, setConversaciones] = useState<Conversacion[]>([]);\r\n  const [conversacionesEstudiante, setConversacionesEstudiante] = useState<ConversacionEstudiante[]>([]);\r\n  const [conversacionActiva, setConversacionActiva] = useState<number | null>(null);\r\n  const [mensajesActivos, setMensajesActivos] = useState<MensajeConDetalles[]>([]);\r\n  const [estudiantes, setEstudiantes] = useState<Estudiante[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [busqueda, setBusqueda] = useState('');\r\n  const [mostrarNuevoMensaje, setMostrarNuevoMensaje] = useState(false);\r\n  const [mostrarRespuesta, setMostrarRespuesta] = useState(false);\r\n  const [mensajeAResponder, setMensajeAResponder] = useState<MensajeConDetalles | null>(null);\r\n  \r\n  const [estadisticas, setEstadisticas] = useState({\r\n    total: 0,\r\n    noLeidos: 0,\r\n    leidos: 0,\r\n    porTipo: {\r\n      general: 0,\r\n      urgente: 0,\r\n      academico: 0,\r\n      conductual: 0,\r\n      felicitacion: 0\r\n    }\r\n  });\r\n\r\n  // formulario de mensaje\r\n  const [formMensaje, setFormMensaje] = useState({\r\n    estudiante_id: '',\r\n    asunto: '',\r\n    mensaje: '',\r\n    tipo: 'general' as 'general' | 'urgente' | 'academico' | 'conductual' | 'felicitacion',\r\n    destinatario_tipo: 'tutor' as 'tutor' | 'estudiante' | 'docente'\r\n  });\r\n\r\n  const chatEndRef = useRef<HTMLDivElement>(null);\r\n  \r\n  // determinar ID y rol del usuario actual\r\n  const esDocente = usuarioActual.rol === 'docente';\r\n  const esEstudiante = usuarioActual.rol === 'estudiante';\r\n  \r\n  // Para docentes: ID de docentes, Para estudiantes: ID de Estudiantes\r\n  const usuarioId = usuarioActual.detalles?.id || 1;\r\n  const estudianteId = esEstudiante ? usuarioActual.detalles?.id : null;\r\n\r\n  useEffect(() => {\r\n    cargarDatos();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (conversacionActiva) {\r\n      cargarMensajesEstudiante(conversacionActiva);\r\n    }\r\n  }, [conversacionActiva]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [mensajesActivos]);\r\n\r\n  const scrollToBottom = () => {\r\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const cargarDatos = async () => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      // cargar estudiantes\r\n      const { data: estudiantesData, error: estudiantesError } = await supabase\r\n        .from('Estudiantes')\r\n        .select('id, nombre, apellido, grado, seccion, email')\r\n        .order('apellido', { ascending: true });\r\n\r\n      if (estudiantesError) throw estudiantesError;\r\n      setEstudiantes(estudiantesData || []);\r\n\r\n      // cargar conversaciones (solo para docentes)\r\n      if (esDocente) {\r\n        const conversacionesData = await getConversaciones(usuarioId);\r\n        setConversaciones(conversacionesData);\r\n\r\n        // cargar estadÃ­sticas\r\n        const stats = await getEstadisticasMensajes(usuarioId);\r\n        setEstadisticas(stats);\r\n      } else if (esEstudiante && estudianteId) {\r\n        // para estudiantes, cargar sus conversaciones agrupadas por docente\r\n        const conversacionesData = await getConversacionesEstudiante(estudianteId);\r\n        setConversacionesEstudiante(conversacionesData);\r\n        \r\n        // obtener todos los mensajes para las estadÃ­sticas\r\n        const mensajesEstudiante = await getMensajesPorEstudiante(estudianteId);\r\n        \r\n        // actualizar estadÃ­sticas para estudiantes\r\n        setEstadisticas({\r\n          total: mensajesEstudiante.length,\r\n          noLeidos: mensajesEstudiante.filter(m => !m.leido && m.destinatario_tipo === 'estudiante').length,\r\n          leidos: mensajesEstudiante.filter(m => m.leido || m.remitente_tipo === 'estudiante').length,\r\n          porTipo: {\r\n            general: mensajesEstudiante.filter(m => m.tipo === 'general').length,\r\n            urgente: mensajesEstudiante.filter(m => m.tipo === 'urgente').length,\r\n            academico: mensajesEstudiante.filter(m => m.tipo === 'academico').length,\r\n            conductual: mensajesEstudiante.filter(m => m.tipo === 'conductual').length,\r\n            felicitacion: mensajesEstudiante.filter(m => m.tipo === 'felicitacion').length\r\n          }\r\n        });\r\n      }\r\n\r\n      setError(null);\r\n    } catch (err: any) {\r\n      setError('Error al cargar datos: ' + err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const cargarMensajesEstudiante = async (idConversacion: number) => {\r\n    try {\r\n      let mensajes: MensajeConDetalles[] = [];\r\n      \r\n      if (esDocente) {\r\n        // Docente viendo conversaciÃ³n con un estudiante\r\n        mensajes = await getMensajesConversacionPrivada(usuarioId, idConversacion);\r\n        // Marcar como leÃ­dos los mensajes de esta conversaciÃ³n\r\n        await marcarConversacionLeida(idConversacion, usuarioId);\r\n      } else if (esEstudiante && estudianteId) {\r\n        // Estudiante viendo conversaciÃ³n con un docente\r\n        // idConversacion es el ID del docente\r\n        mensajes = await getMensajesConversacionPrivada(idConversacion, estudianteId);\r\n        // Marcar como leÃ­dos los mensajes del docente\r\n        await marcarConversacionLeida(estudianteId, idConversacion);\r\n      }\r\n      \r\n      setMensajesActivos(mensajes);\r\n      \r\n      // actualizar conversaciones\r\n      cargarDatos();\r\n    } catch (err: any) {\r\n      setError('Error al cargar mensajes: ' + err.message);\r\n    }\r\n  };\r\n\r\n  const handleEnviarMensaje = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!formMensaje.estudiante_id || !formMensaje.asunto || !formMensaje.mensaje) {\r\n      setError('Por favor completa todos los campos obligatorios');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      await crearMensaje({\r\n        remitente_tipo: usuarioActual.rol as any,\r\n        remitente_id: usuarioId,\r\n        destinatario_tipo: formMensaje.destinatario_tipo,\r\n        destinatario_id: undefined, // se enviarÃ­a al tutor o estudiante segÃºn el caso\r\n        estudiante_id: parseInt(formMensaje.estudiante_id),\r\n        asunto: formMensaje.asunto,\r\n        mensaje: formMensaje.mensaje,\r\n        tipo: formMensaje.tipo,\r\n        leido: false\r\n      });\r\n\r\n      showNotification('Mensaje enviado correctamente', 'success');\r\n      \r\n      setFormMensaje({\r\n        estudiante_id: '',\r\n        asunto: '',\r\n        mensaje: '',\r\n        tipo: 'general',\r\n        destinatario_tipo: 'tutor'\r\n      });\r\n\r\n      setMostrarNuevoMensaje(false);\r\n      cargarDatos();\r\n\r\n      // si estamos en la conversaciÃ³n de este estudiante, recargar mensajes\r\n      if (conversacionActiva === parseInt(formMensaje.estudiante_id)) {\r\n        cargarMensajesEstudiante(conversacionActiva);\r\n      }\r\n\r\n    } catch (err: any) {\r\n      const errorMessage = err.message || 'Error desconocido';\r\n      setError('Error al enviar mensaje: ' + errorMessage);\r\n      showNotification('Error al enviar mensaje: ' + errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRespuestaRapida = (respuesta: string) => {\r\n    setFormMensaje({ ...formMensaje, mensaje: respuesta });\r\n  };\r\n\r\n  const handleResponder = (mensaje: MensajeConDetalles) => {\r\n    setMensajeAResponder(mensaje);\r\n    setMostrarRespuesta(true);\r\n  };\r\n\r\n  const handleEnviarRespuesta = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!formMensaje.mensaje) {\r\n      setError('Por favor escribe tu respuesta');\r\n      return;\r\n    }\r\n\r\n    if (!mensajeAResponder) {\r\n      setError('No hay mensaje para responder');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Para estudiantes que responden: el docente es el destinatario\r\n      // Necesitamos obtener el ID del docente que enviÃ³ el mensaje original\r\n      await crearMensaje({\r\n        remitente_tipo: 'estudiante' as any, // El estudiante responde\r\n        remitente_id: usuarioId, // ID del estudiante en la tabla usuarios\r\n        destinatario_tipo: 'docente' as any, // Al docente\r\n        destinatario_id: mensajeAResponder.remitente_id, // ID del docente que enviÃ³ el mensaje\r\n        estudiante_id: estudianteId!, // ID del estudiante\r\n        asunto: `RE: ${mensajeAResponder.asunto}`,\r\n        mensaje: formMensaje.mensaje,\r\n        tipo: formMensaje.tipo,\r\n        leido: false\r\n      });\r\n\r\n      showNotification('Respuesta enviada correctamente', 'success');\r\n      \r\n      setFormMensaje({\r\n        estudiante_id: '',\r\n        asunto: '',\r\n        mensaje: '',\r\n        tipo: 'general',\r\n        destinatario_tipo: 'docente'\r\n      });\r\n\r\n      setMostrarRespuesta(false);\r\n      setMensajeAResponder(null);\r\n      \r\n      // Recargar mensajes de la conversaciÃ³n activa\r\n      if (conversacionActiva) {\r\n        await cargarMensajesEstudiante(conversacionActiva);\r\n      }\r\n\r\n    } catch (err: any) {\r\n      const errorMessage = err.message || 'Error desconocido';\r\n      setError('Error al enviar respuesta: ' + errorMessage);\r\n      showNotification('Error al enviar respuesta: ' + errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getTipoColor = (tipo: string) => {\r\n    switch (tipo) {\r\n      case 'urgente': return { bg: '#fee2e2', text: '#991b1b', icon: 'ðŸš¨' };\r\n      case 'academico': return { bg: '#dbeafe', text: '#1e40af', icon: 'ðŸ“š' };\r\n      case 'conductual': return { bg: '#fef3c7', text: '#92400e', icon: 'âš ï¸' };\r\n      case 'felicitacion': return { bg: '#dcfce7', text: '#166534', icon: 'ðŸŽ‰' };\r\n      default: return { bg: '#f3f4f6', text: '#374151', icon: 'ðŸ’¬' };\r\n    }\r\n  };\r\n\r\n  const getTipoBadge = (tipo: string) => {\r\n    const colores = getTipoColor(tipo);\r\n    return (\r\n      <span style={{\r\n        backgroundColor: colores.bg,\r\n        color: colores.text,\r\n        padding: '4px 10px',\r\n        borderRadius: '12px',\r\n        fontSize: '11px',\r\n        fontWeight: '600',\r\n        display: 'inline-flex',\r\n        alignItems: 'center',\r\n        gap: '4px'\r\n      }}>\r\n        {colores.icon} {tipo.toUpperCase()}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const estudiantesFiltrados = estudiantes.filter(est =>\r\n    `${est.nombre} ${est.apellido}`.toLowerCase().includes(busqueda.toLowerCase()) ||\r\n    est.email?.toLowerCase().includes(busqueda.toLowerCase())\r\n  );\r\n\r\n  // filtrar conversaciones segÃºn el rol\r\n  const conversacionesFiltradas = esDocente\r\n    ? conversaciones.filter(conv =>\r\n        `${conv.estudiante_nombre} ${conv.estudiante_apellido}`.toLowerCase().includes(busqueda.toLowerCase())\r\n      )\r\n    : conversacionesEstudiante.filter(conv =>\r\n        `${conv.docente_nombre} ${conv.docente_apellido}`.toLowerCase().includes(busqueda.toLowerCase())\r\n      );\r\n\r\n  const estudianteActivo = conversacionActiva && esDocente\r\n    ? conversaciones.find(c => c.estudiante_id === conversacionActiva)\r\n    : null;\r\n  \r\n  const docenteActivo = conversacionActiva && esEstudiante\r\n    ? conversacionesEstudiante.find(c => c.docente_id === conversacionActiva)\r\n    : null;\r\n\r\n  return (\r\n    <>\r\n      <NotificationContainer />\r\n    <div style={{ height: 'calc(100vh - 80px)', display: 'flex', flexDirection: 'column', backgroundColor: '#f9fafb' }}>\r\n      {/* Header con EstadÃ­sticas */}\r\n      <div style={{ padding: '20px', backgroundColor: 'white', borderBottom: '1px solid #e5e7eb' }}>\r\n        <h1 style={{ fontSize: '28px', fontWeight: '700', color: '#1a1a1a', marginBottom: '16px' }}>\r\n          ðŸ’¬ {esEstudiante ? 'Mis Mensajes' : 'Sistema de MensajerÃ­a'}\r\n        </h1>\r\n\r\n        {error && (\r\n          <div style={{\r\n            padding: '12px 16px',\r\n            backgroundColor: '#fee2e2',\r\n            border: '1px solid #fecaca',\r\n            color: '#b91c1c',\r\n            borderRadius: '8px',\r\n            marginBottom: '16px',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '8px'\r\n          }}>\r\n            <span>âš ï¸</span>\r\n            <span>{error}</span>\r\n            <button\r\n              onClick={() => setError(null)}\r\n              style={{\r\n                marginLeft: 'auto',\r\n                background: 'none',\r\n                border: 'none',\r\n                fontSize: '18px',\r\n                cursor: 'pointer',\r\n                color: '#b91c1c'\r\n              }}\r\n            >\r\n              âœ•\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '12px' }}>\r\n          <div style={{ backgroundColor: '#ede9fe', padding: '16px', borderRadius: '10px', border: '1px solid #ddd6fe' }}>\r\n            <div style={{ fontSize: '24px', fontWeight: '700', color: '#7c3aed' }}>\r\n              {estadisticas.total}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#6d28d9', fontWeight: '500' }}>Total Mensajes</div>\r\n          </div>\r\n\r\n          <div style={{ backgroundColor: '#dbeafe', padding: '16px', borderRadius: '10px', border: '1px solid #bfdbfe' }}>\r\n            <div style={{ fontSize: '24px', fontWeight: '700', color: '#2563eb' }}>\r\n              {conversaciones.length}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#1d4ed8', fontWeight: '500' }}>Conversaciones</div>\r\n          </div>\r\n\r\n          <div style={{ backgroundColor: '#fef3c7', padding: '16px', borderRadius: '10px', border: '1px solid #fde68a' }}>\r\n            <div style={{ fontSize: '24px', fontWeight: '700', color: '#d97706' }}>\r\n              {estadisticas.noLeidos}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#b45309', fontWeight: '500' }}>Sin Leer</div>\r\n          </div>\r\n\r\n          <div style={{ backgroundColor: '#dcfce7', padding: '16px', borderRadius: '10px', border: '1px solid #a7f3d0' }}>\r\n            <div style={{ fontSize: '24px', fontWeight: '700', color: '#059669' }}>\r\n              {estadisticas.leidos}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#047857', fontWeight: '500' }}>LeÃ­dos</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Layout principal estilo WhatsApp */}\r\n      <div style={{ flex: 1, display: 'flex', overflow: 'hidden' }}>\r\n        {/* Panel izquierdo: Lista de conversaciones */}\r\n        {(esDocente || esEstudiante) && (\r\n        <div style={{\r\n          width: '350px',\r\n          backgroundColor: 'white',\r\n          borderRight: '1px solid #e5e7eb',\r\n          display: 'flex',\r\n          flexDirection: 'column'\r\n        }}>\r\n          {/* BÃºsqueda y botÃ³n nuevo */}\r\n          <div style={{ padding: '16px', borderBottom: '1px solid #e5e7eb' }}>\r\n            <div style={{ marginBottom: esDocente ? '12px' : '0' }}>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"ðŸ” Buscar conversaciÃ³n...\"\r\n                value={busqueda}\r\n                onChange={(e) => setBusqueda(e.target.value)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '10px 12px',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '8px',\r\n                  fontSize: '14px'\r\n                }}\r\n              />\r\n            </div>\r\n            {esDocente && (\r\n              <button\r\n                onClick={() => setMostrarNuevoMensaje(true)}\r\n                style={{\r\n                  width: '100%',\r\n                  backgroundColor: '#3b82f6',\r\n                  color: 'white',\r\n                  padding: '10px',\r\n                  borderRadius: '8px',\r\n                  border: 'none',\r\n                  fontSize: '14px',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  gap: '8px'\r\n                }}\r\n              >\r\n                âœï¸ Nuevo Mensaje\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Lista de conversaciones */}\r\n          <div style={{ flex: 1, overflowY: 'auto' }}>\r\n            {loading ? (\r\n              <div style={{ padding: '40px', textAlign: 'center', color: '#9ca3af' }}>\r\n                <div style={{ fontSize: '32px', marginBottom: '12px' }}>â³</div>\r\n                <p>Cargando...</p>\r\n              </div>\r\n            ) : conversacionesFiltradas.length === 0 ? (\r\n              <div style={{ padding: '40px', textAlign: 'center', color: '#9ca3af' }}>\r\n                <div style={{ fontSize: '48px', marginBottom: '12px' }}>ðŸ“­</div>\r\n                <p style={{ fontSize: '14px' }}>No hay conversaciones</p>\r\n              </div>\r\n            ) : esDocente ? (\r\n              // Vista de conversaciones para docentes\r\n              (conversacionesFiltradas as Conversacion[]).map((conv) => (\r\n                <div\r\n                  key={conv.estudiante_id}\r\n                  onClick={() => setConversacionActiva(conv.estudiante_id)}\r\n                  style={{\r\n                    padding: '16px',\r\n                    borderBottom: '1px solid #f3f4f6',\r\n                    cursor: 'pointer',\r\n                    backgroundColor: conversacionActiva === conv.estudiante_id ? '#f0f9ff' : 'white',\r\n                    transition: 'background-color 0.2s'\r\n                  }}\r\n                  onMouseOver={(e) => {\r\n                    if (conversacionActiva !== conv.estudiante_id) {\r\n                      e.currentTarget.style.backgroundColor = '#f9fafb';\r\n                    }\r\n                  }}\r\n                  onMouseOut={(e) => {\r\n                    if (conversacionActiva !== conv.estudiante_id) {\r\n                      e.currentTarget.style.backgroundColor = 'white';\r\n                    }\r\n                  }}\r\n                >\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n                    <div style={{\r\n                      width: '48px',\r\n                      height: '48px',\r\n                      borderRadius: '50%',\r\n                      backgroundColor: '#e0e7ff',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      fontSize: '20px',\r\n                      fontWeight: '600',\r\n                      color: '#4f46e5',\r\n                      flexShrink: 0\r\n                    }}>\r\n                      {conv.estudiante_nombre.charAt(0)}{conv.estudiante_apellido.charAt(0)}\r\n                    </div>\r\n                    <div style={{ flex: 1, minWidth: 0 }}>\r\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>\r\n                        <div style={{ fontWeight: '600', color: '#1f2937', fontSize: '14px' }}>\r\n                          {conv.estudiante_apellido} {conv.estudiante_nombre}\r\n                        </div>\r\n                        {conv.mensajes_no_leidos > 0 && (\r\n                          <div style={{\r\n                            backgroundColor: '#3b82f6',\r\n                            color: 'white',\r\n                            borderRadius: '12px',\r\n                            padding: '2px 8px',\r\n                            fontSize: '11px',\r\n                            fontWeight: '700'\r\n                          }}>\r\n                            {conv.mensajes_no_leidos}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div style={{ fontSize: '11px', color: '#9ca3af', marginBottom: '4px' }}>\r\n                        {conv.estudiante_grado}{conv.estudiante_seccion}\r\n                      </div>\r\n                      <div style={{\r\n                        fontSize: '13px',\r\n                        color: '#6b7280',\r\n                        whiteSpace: 'nowrap',\r\n                        overflow: 'hidden',\r\n                        textOverflow: 'ellipsis'\r\n                      }}>\r\n                        {conv.ultimo_mensaje}\r\n                      </div>\r\n                      <div style={{ marginTop: '4px' }}>\r\n                        {getTipoBadge(conv.ultimo_mensaje_tipo)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              // Vista de conversaciones para estudiantes\r\n              (conversacionesFiltradas as ConversacionEstudiante[]).map((conv) => (\r\n                <div\r\n                  key={conv.docente_id}\r\n                  onClick={() => setConversacionActiva(conv.docente_id)}\r\n                  style={{\r\n                    padding: '16px',\r\n                    borderBottom: '1px solid #f3f4f6',\r\n                    cursor: 'pointer',\r\n                    backgroundColor: conversacionActiva === conv.docente_id ? '#f0f9ff' : 'white',\r\n                    transition: 'background-color 0.2s'\r\n                  }}\r\n                  onMouseOver={(e) => {\r\n                    if (conversacionActiva !== conv.docente_id) {\r\n                      e.currentTarget.style.backgroundColor = '#f9fafb';\r\n                    }\r\n                  }}\r\n                  onMouseOut={(e) => {\r\n                    if (conversacionActiva !== conv.docente_id) {\r\n                      e.currentTarget.style.backgroundColor = 'white';\r\n                    }\r\n                  }}\r\n                >\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n                    <div style={{\r\n                      width: '48px',\r\n                      height: '48px',\r\n                      borderRadius: '50%',\r\n                      backgroundColor: '#fce7f3',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      fontSize: '20px',\r\n                      fontWeight: '600',\r\n                      color: '#be123c',\r\n                      flexShrink: 0\r\n                    }}>\r\n                      {conv.docente_nombre.charAt(0)}{conv.docente_apellido.charAt(0)}\r\n                    </div>\r\n                    <div style={{ flex: 1, minWidth: 0 }}>\r\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>\r\n                        <div style={{ fontWeight: '600', color: '#1f2937', fontSize: '14px' }}>\r\n                          Prof. {conv.docente_apellido} {conv.docente_nombre}\r\n                        </div>\r\n                        {conv.mensajes_no_leidos > 0 && (\r\n                          <div style={{\r\n                            backgroundColor: '#ef4444',\r\n                            color: 'white',\r\n                            borderRadius: '12px',\r\n                            padding: '2px 8px',\r\n                            fontSize: '11px',\r\n                            fontWeight: '700'\r\n                          }}>\r\n                            {conv.mensajes_no_leidos}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div style={{ fontSize: '11px', color: '#9ca3af', marginBottom: '4px' }}>\r\n                        {conv.docente_especialidad || 'Docente'}\r\n                      </div>\r\n                      <div style={{\r\n                        fontSize: '13px',\r\n                        color: '#6b7280',\r\n                        whiteSpace: 'nowrap',\r\n                        overflow: 'hidden',\r\n                        textOverflow: 'ellipsis'\r\n                      }}>\r\n                        {conv.ultimo_mensaje}\r\n                      </div>\r\n                      <div style={{ marginTop: '4px' }}>\r\n                        {getTipoBadge(conv.ultimo_mensaje_tipo)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n        )}\r\n\r\n        {/* Panel derecho: Chat activo o formulario nuevo mensaje */}\r\n        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', backgroundColor: '#f9fafb' }}>\r\n          {mostrarRespuesta && esEstudiante ? (\r\n            // Formulario de respuesta para estudiantes\r\n            <div style={{ flex: 1, padding: '24px', overflowY: 'auto' }}>\r\n              <div style={{ maxWidth: '700px', margin: '0 auto' }}>\r\n                <div style={{\r\n                  backgroundColor: 'white',\r\n                  borderRadius: '12px',\r\n                  padding: '24px',\r\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\r\n                  border: '1px solid #e5e7eb'\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>\r\n                    <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#374151' }}>\r\n                      â†©ï¸ Responder Mensaje\r\n                    </h2>\r\n                    <button\r\n                      onClick={() => {\r\n                        setMostrarRespuesta(false);\r\n                        setMensajeAResponder(null);\r\n                      }}\r\n                      style={{\r\n                        background: 'none',\r\n                        border: 'none',\r\n                        fontSize: '24px',\r\n                        cursor: 'pointer',\r\n                        color: '#9ca3af'\r\n                      }}\r\n                    >\r\n                      âœ•\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Mensaje original */}\r\n                  <div style={{\r\n                    backgroundColor: '#f9fafb',\r\n                    padding: '16px',\r\n                    borderRadius: '8px',\r\n                    marginBottom: '24px',\r\n                    borderLeft: '4px solid #3b82f6'\r\n                  }}>\r\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginBottom: '8px' }}>\r\n                      Mensaje original de tu profesor:\r\n                    </div>\r\n                    <div style={{ fontWeight: '600', fontSize: '14px', marginBottom: '4px' }}>\r\n                      {mensajeAResponder?.asunto}\r\n                    </div>\r\n                    <div style={{ fontSize: '14px', color: '#374151' }}>\r\n                      {mensajeAResponder?.mensaje}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <form onSubmit={handleEnviarRespuesta}>\r\n                    <div style={{ marginBottom: '20px' }}>\r\n                      <label style={labelStyle}>Tipo de Mensaje</label>\r\n                      <select\r\n                        value={formMensaje.tipo}\r\n                        onChange={(e) => setFormMensaje({ ...formMensaje, tipo: e.target.value as any })}\r\n                        style={inputStyle}\r\n                      >\r\n                        <option value=\"general\">ðŸ’¬ General</option>\r\n                        <option value=\"academico\">ðŸ“š AcadÃ©mico</option>\r\n                        <option value=\"conductual\">âš ï¸ Conductual</option>\r\n                      </select>\r\n                    </div>\r\n\r\n                    <div style={{ marginBottom: '20px' }}>\r\n                      <label style={labelStyle}>Tu Respuesta *</label>\r\n                      <textarea\r\n                        value={formMensaje.mensaje}\r\n                        onChange={(e) => setFormMensaje({ ...formMensaje, mensaje: e.target.value })}\r\n                        style={{ ...inputStyle, minHeight: '150px', resize: 'vertical' }}\r\n                        placeholder=\"Escribe tu respuesta aquÃ­...\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', gap: '12px' }}>\r\n                      <button\r\n                        type=\"submit\"\r\n                        disabled={loading}\r\n                        style={{\r\n                          flex: 1,\r\n                          backgroundColor: loading ? '#9ca3af' : '#10b981',\r\n                          color: 'white',\r\n                          padding: '12px',\r\n                          borderRadius: '8px',\r\n                          border: 'none',\r\n                          fontSize: '15px',\r\n                          fontWeight: '600',\r\n                          cursor: loading ? 'not-allowed' : 'pointer'\r\n                        }}\r\n                      >\r\n                        {loading ? 'â³ Enviando...' : 'ðŸ“¤ Enviar Respuesta'}\r\n                      </button>\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                          setMostrarRespuesta(false);\r\n                          setMensajeAResponder(null);\r\n                        }}\r\n                        style={{\r\n                          backgroundColor: '#6b7280',\r\n                          color: 'white',\r\n                          padding: '12px 24px',\r\n                          borderRadius: '8px',\r\n                          border: 'none',\r\n                          fontSize: '15px',\r\n                          fontWeight: '600',\r\n                          cursor: 'pointer'\r\n                        }}\r\n                      >\r\n                        Cancelar\r\n                      </button>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : mostrarNuevoMensaje ? (\r\n            // Formulario nuevo mensaje\r\n            <div style={{ flex: 1, padding: '24px', overflowY: 'auto' }}>\r\n              <div style={{ maxWidth: '700px', margin: '0 auto' }}>\r\n                <div style={{\r\n                  backgroundColor: 'white',\r\n                  borderRadius: '12px',\r\n                  padding: '24px',\r\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\r\n                  border: '1px solid #e5e7eb'\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>\r\n                    <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#374151' }}>\r\n                      âœï¸ Nuevo Mensaje\r\n                    </h2>\r\n                    <button\r\n                      onClick={() => setMostrarNuevoMensaje(false)}\r\n                      style={{\r\n                        background: 'none',\r\n                        border: 'none',\r\n                        fontSize: '24px',\r\n                        cursor: 'pointer',\r\n                        color: '#9ca3af'\r\n                      }}\r\n                    >\r\n                      âœ•\r\n                    </button>\r\n                  </div>\r\n\r\n                  <form onSubmit={handleEnviarMensaje}>\r\n                    <div style={{ marginBottom: '20px' }}>\r\n                      <label style={labelStyle}>Estudiante *</label>\r\n                      <select\r\n                        value={formMensaje.estudiante_id}\r\n                        onChange={(e) => setFormMensaje({ ...formMensaje, estudiante_id: e.target.value })}\r\n                        style={inputStyle}\r\n                        required\r\n                      >\r\n                        <option value=\"\">Seleccionar estudiante</option>\r\n                        {estudiantesFiltrados.map(est => (\r\n                          <option key={est.id} value={est.id}>\r\n                            {est.apellido} {est.nombre} - {est.grado}{est.seccion}\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '20px' }}>\r\n                      <div>\r\n                        <label style={labelStyle}>Destinatario *</label>\r\n                        <select\r\n                          value={formMensaje.destinatario_tipo}\r\n                          onChange={(e) => setFormMensaje({ ...formMensaje, destinatario_tipo: e.target.value as any })}\r\n                          style={inputStyle}\r\n                        >\r\n                          <option value=\"tutor\">ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦ Tutor/Apoderado</option>\r\n                          <option value=\"estudiante\">ðŸŽ“ Estudiante</option>\r\n                        </select>\r\n                      </div>\r\n\r\n                      <div>\r\n                        <label style={labelStyle}>Tipo de Mensaje *</label>\r\n                        <select\r\n                          value={formMensaje.tipo}\r\n                          onChange={(e) => setFormMensaje({ ...formMensaje, tipo: e.target.value as any })}\r\n                          style={inputStyle}\r\n                        >\r\n                          <option value=\"general\">ðŸ’¬ General</option>\r\n                          <option value=\"academico\">ðŸ“š AcadÃ©mico</option>\r\n                          <option value=\"conductual\">âš ï¸ Conductual</option>\r\n                          <option value=\"urgente\">ðŸš¨ Urgente</option>\r\n                          <option value=\"felicitacion\">ðŸŽ‰ FelicitaciÃ³n</option>\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div style={{ marginBottom: '20px' }}>\r\n                      <label style={labelStyle}>Asunto *</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={formMensaje.asunto}\r\n                        onChange={(e) => setFormMensaje({ ...formMensaje, asunto: e.target.value })}\r\n                        style={inputStyle}\r\n                        placeholder=\"Ej: RevisiÃ³n de calificaciones\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    <div style={{ marginBottom: '16px' }}>\r\n                      <label style={labelStyle}>Mensaje *</label>\r\n                      <textarea\r\n                        value={formMensaje.mensaje}\r\n                        onChange={(e) => setFormMensaje({ ...formMensaje, mensaje: e.target.value })}\r\n                        style={{ ...inputStyle, minHeight: '120px', resize: 'vertical' }}\r\n                        placeholder=\"Escribe tu mensaje aquÃ­...\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Respuestas rÃ¡pidas */}\r\n                    <div style={{ marginBottom: '20px' }}>\r\n                      <label style={{ ...labelStyle, marginBottom: '8px' }}>âš¡ Respuestas RÃ¡pidas:</label>\r\n                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>\r\n                        {RESPUESTAS_RAPIDAS.map((respuesta, idx) => (\r\n                          <button\r\n                            key={idx}\r\n                            type=\"button\"\r\n                            onClick={() => handleRespuestaRapida(respuesta)}\r\n                            style={{\r\n                              backgroundColor: '#f3f4f6',\r\n                              border: '1px solid #d1d5db',\r\n                              padding: '6px 12px',\r\n                              borderRadius: '16px',\r\n                              fontSize: '12px',\r\n                              cursor: 'pointer',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                            onMouseOver={(e) => {\r\n                              e.currentTarget.style.backgroundColor = '#e5e7eb';\r\n                              e.currentTarget.style.borderColor = '#9ca3af';\r\n                            }}\r\n                            onMouseOut={(e) => {\r\n                              e.currentTarget.style.backgroundColor = '#f3f4f6';\r\n                              e.currentTarget.style.borderColor = '#d1d5db';\r\n                            }}\r\n                          >\r\n                            {respuesta}\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', gap: '12px' }}>\r\n                      <button\r\n                        type=\"submit\"\r\n                        disabled={loading}\r\n                        style={{\r\n                          flex: 1,\r\n                          backgroundColor: loading ? '#9ca3af' : '#10b981',\r\n                          color: 'white',\r\n                          padding: '12px',\r\n                          borderRadius: '8px',\r\n                          border: 'none',\r\n                          fontSize: '15px',\r\n                          fontWeight: '600',\r\n                          cursor: loading ? 'not-allowed' : 'pointer'\r\n                        }}\r\n                      >\r\n                        {loading ? 'â³ Enviando...' : 'ðŸ“¤ Enviar Mensaje'}\r\n                      </button>\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => setMostrarNuevoMensaje(false)}\r\n                        style={{\r\n                          backgroundColor: '#6b7280',\r\n                          color: 'white',\r\n                          padding: '12px 24px',\r\n                          borderRadius: '8px',\r\n                          border: 'none',\r\n                          fontSize: '15px',\r\n                          fontWeight: '600',\r\n                          cursor: 'pointer'\r\n                        }}\r\n                      >\r\n                        Cancelar\r\n                      </button>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (esDocente && conversacionActiva && estudianteActivo) || (esEstudiante && conversacionActiva && docenteActivo) ? (\r\n            // Vista de chat\r\n            <>\r\n              {/* Header del chat */}\r\n              <div style={{\r\n                backgroundColor: 'white',\r\n                padding: '16px 24px',\r\n                borderBottom: '1px solid #e5e7eb',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '12px'\r\n              }}>\r\n                {esDocente && estudianteActivo ? (\r\n                  <>\r\n                    <div style={{\r\n                      width: '48px',\r\n                      height: '48px',\r\n                      borderRadius: '50%',\r\n                      backgroundColor: '#e0e7ff',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      fontSize: '20px',\r\n                      fontWeight: '600',\r\n                      color: '#4f46e5'\r\n                    }}>\r\n                      {estudianteActivo.estudiante_nombre.charAt(0)}{estudianteActivo.estudiante_apellido.charAt(0)}\r\n                    </div>\r\n                    <div style={{ flex: 1 }}>\r\n                      <div style={{ fontWeight: '600', fontSize: '16px', color: '#1f2937' }}>\r\n                        {estudianteActivo.estudiante_apellido} {estudianteActivo.estudiante_nombre}\r\n                      </div>\r\n                      <div style={{ fontSize: '13px', color: '#6b7280' }}>\r\n                        {estudianteActivo.estudiante_grado}{estudianteActivo.estudiante_seccion} â€¢ {estudianteActivo.total_mensajes} mensajes\r\n                      </div>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => setConversacionActiva(null)}\r\n                      style={{\r\n                        background: 'none',\r\n                        border: 'none',\r\n                        fontSize: '24px',\r\n                        cursor: 'pointer',\r\n                        color: '#9ca3af'\r\n                      }}\r\n                    >\r\n                      âœ•\r\n                    </button>\r\n                  </>\r\n                ) : esEstudiante && docenteActivo ? (\r\n                  <>\r\n                    <div style={{\r\n                      width: '48px',\r\n                      height: '48px',\r\n                      borderRadius: '50%',\r\n                      backgroundColor: '#fce7f3',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      fontSize: '20px',\r\n                      fontWeight: '600',\r\n                      color: '#be123c'\r\n                    }}>\r\n                      {docenteActivo.docente_nombre.charAt(0)}{docenteActivo.docente_apellido.charAt(0)}\r\n                    </div>\r\n                    <div style={{ flex: 1 }}>\r\n                      <div style={{ fontWeight: '600', fontSize: '16px', color: '#1f2937' }}>\r\n                        Prof. {docenteActivo.docente_apellido} {docenteActivo.docente_nombre}\r\n                      </div>\r\n                      <div style={{ fontSize: '13px', color: '#6b7280' }}>\r\n                        {docenteActivo.docente_especialidad || 'Docente'} â€¢ {docenteActivo.total_mensajes} mensajes\r\n                      </div>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => setConversacionActiva(null)}\r\n                      style={{\r\n                        background: 'none',\r\n                        border: 'none',\r\n                        fontSize: '24px',\r\n                        cursor: 'pointer',\r\n                        color: '#9ca3af'\r\n                      }}\r\n                    >\r\n                      âœ•\r\n                    </button>\r\n                  </>\r\n                ) : null}\r\n              </div>\r\n\r\n              {/* Mensajes */}\r\n              <div style={{\r\n                flex: 1,\r\n                overflowY: 'auto',\r\n                padding: '24px',\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                gap: '16px'\r\n              }}>\r\n                {mensajesActivos.length === 0 ? (\r\n                  <div style={{ textAlign: 'center', padding: '60px 20px', color: '#9ca3af' }}>\r\n                    <div style={{ fontSize: '64px', marginBottom: '16px' }}>ðŸ’¬</div>\r\n                    <p style={{ fontSize: '16px', fontWeight: '500', color: '#6b7280' }}>\r\n                      No hay mensajes en esta conversaciÃ³n\r\n                    </p>\r\n                    <p style={{ fontSize: '14px', marginTop: '8px' }}>\r\n                      Â¡EnvÃ­a el primer mensaje!\r\n                    </p>\r\n                  </div>\r\n                ) : (\r\n                  mensajesActivos.map((mensaje) => {\r\n                    // determinar si el mensaje es del usuario actual\r\n                    const esMioElMensaje = (\r\n                      esEstudiante && \r\n                      (mensaje.remitente_tipo as string) === 'estudiante' && \r\n                      mensaje.remitente_id === usuarioId\r\n                    ) || (\r\n                      esDocente && \r\n                      (mensaje.remitente_tipo as string) === 'docente' && \r\n                      mensaje.remitente_id === usuarioId\r\n                    );\r\n                    \r\n                    return (\r\n                      <div\r\n                        key={mensaje.id}\r\n                        style={{\r\n                          display: 'flex',\r\n                          justifyContent: esMioElMensaje ? 'flex-end' : 'flex-start',\r\n                          marginBottom: '12px'\r\n                        }}\r\n                      >\r\n                        <div style={{\r\n                          maxWidth: '70%',\r\n                          backgroundColor: esMioElMensaje ? '#10b981' : '#3b82f6',\r\n                          color: 'white',\r\n                          padding: '12px 16px',\r\n                          borderRadius: esMioElMensaje ? '16px 16px 4px 16px' : '16px 16px 16px 4px',\r\n                          boxShadow: `0 2px 4px rgba(${esMioElMensaje ? '16, 185, 129' : '59, 130, 246'}, 0.3)`\r\n                        }}>\r\n                          <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px', flexWrap: 'wrap' }}>\r\n                            {getTipoBadge(mensaje.tipo || 'general')}\r\n                            <span style={{ fontSize: '11px', opacity: 0.9 }}>\r\n                              {esMioElMensaje \r\n                                ? (esEstudiante ? `TÃº â†’ Profesor ${mensaje.docente?.apellido || ''}` : `TÃº â†’ ${mensaje.estudiante?.apellido || 'estudiante'}`)\r\n                                : (esEstudiante \r\n                                    ? `De: Prof. ${mensaje.docente?.nombre} ${mensaje.docente?.apellido}` \r\n                                    : `Respuesta de: ${mensaje.estudiante?.nombre} ${mensaje.estudiante?.apellido}`\r\n                                  )\r\n                              }\r\n                            </span>\r\n                          </div>\r\n                          <div style={{ fontWeight: '600', fontSize: '14px', marginBottom: '8px' }}>\r\n                            {mensaje.asunto}\r\n                          </div>\r\n                          <div style={{ fontSize: '14px', lineHeight: '1.5', marginBottom: '8px' }}>\r\n                            {mensaje.mensaje}\r\n                          </div>\r\n                          <div style={{ \r\n                            display: 'flex', \r\n                            justifyContent: 'space-between', \r\n                            alignItems: 'center',\r\n                            gap: '12px',\r\n                            flexWrap: 'wrap'\r\n                          }}>\r\n                            <div style={{ fontSize: '11px', opacity: 0.8 }}>\r\n                              {new Date(mensaje.created_at!).toLocaleString('es-ES', {\r\n                                day: '2-digit',\r\n                                month: '2-digit',\r\n                                year: 'numeric',\r\n                                hour: '2-digit',\r\n                                minute: '2-digit'\r\n                              })}\r\n                              {mensaje.leido && ' â€¢ âœ“âœ“'}\r\n                            </div>\r\n                            {esEstudiante && !esMioElMensaje && (\r\n                              <button\r\n                                onClick={() => handleResponder(mensaje)}\r\n                                style={{\r\n                                  backgroundColor: 'rgba(255, 255, 255, 0.2)',\r\n                                  color: 'white',\r\n                                  border: '1px solid rgba(255, 255, 255, 0.3)',\r\n                                  padding: '4px 12px',\r\n                                  borderRadius: '12px',\r\n                                  fontSize: '12px',\r\n                                  fontWeight: '600',\r\n                                  cursor: 'pointer',\r\n                                  transition: 'all 0.2s'\r\n                                }}\r\n                                onMouseOver={(e) => e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.3)'}\r\n                                onMouseOut={(e) => e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.2)'}\r\n                              >\r\n                                â†©ï¸ Responder\r\n                              </button>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })\r\n                )}\r\n                <div ref={chatEndRef} />\r\n              </div>\r\n\r\n              {/* BotÃ³n flotante para nuevo mensaje en esta conversaciÃ³n (solo docentes) */}\r\n              {esDocente && conversacionActiva && (\r\n                <div style={{\r\n                  backgroundColor: 'white',\r\n                  borderTop: '1px solid #e5e7eb',\r\n                  padding: '16px 24px'\r\n                }}>\r\n                  <button\r\n                    onClick={() => {\r\n                      setFormMensaje({\r\n                        ...formMensaje,\r\n                        estudiante_id: conversacionActiva.toString()\r\n                      });\r\n                      setMostrarNuevoMensaje(true);\r\n                    }}\r\n                    style={{\r\n                      width: '100%',\r\n                      backgroundColor: '#3b82f6',\r\n                      color: 'white',\r\n                      padding: '12px',\r\n                      borderRadius: '8px',\r\n                      border: 'none',\r\n                      fontSize: '14px',\r\n                      fontWeight: '600',\r\n                      cursor: 'pointer',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      gap: '8px'\r\n                    }}\r\n                  >\r\n                    âœï¸ Escribir Nuevo Mensaje\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            // Estado vacÃ­o\r\n            <div style={{\r\n              flex: 1,\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              flexDirection: 'column',\r\n              color: '#9ca3af'\r\n            }}>\r\n              <div style={{ fontSize: '96px', marginBottom: '24px' }}>ðŸ’¬</div>\r\n              <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#6b7280', marginBottom: '8px' }}>\r\n                Selecciona una conversaciÃ³n\r\n              </h3>\r\n              <p style={{ fontSize: '14px' }}>\r\n                o crea un nuevo mensaje con el botÃ³n de arriba\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst labelStyle: React.CSSProperties = {\r\n  display: 'block',\r\n  marginBottom: '8px',\r\n  fontWeight: '500',\r\n  fontSize: '14px',\r\n  color: '#374151'\r\n};\r\n\r\nconst inputStyle: React.CSSProperties = {\r\n  width: '100%',\r\n  padding: '10px 12px',\r\n  border: '1px solid #d1d5db',\r\n  borderRadius: '8px',\r\n  fontSize: '14px',\r\n  outline: 'none'\r\n};\r\n\r\nexport default MessagingSystem;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}