{"ast":null,"code":"import { supabase } from '../supabaseClient';\n\n// interfaz extendida con información del estudiante y docente\n\n// interfaz para agrupar mensajes por conversación (docente)\n\n// interfaz para conversaciones del estudiante\n\n// crear un mensaje\nexport const crearMensaje = async mensaje => {\n  const {\n    data,\n    error\n  } = await supabase.from('mensajes').insert(mensaje).select().single();\n  if (error) throw error;\n  return data;\n};\n\n// obtener todas las conversaciones agrupadas por estudiante\nexport const getConversaciones = async docenteId => {\n  // obtener todos los mensajes donde el docente es remitente\n  const {\n    data: mensajes,\n    error\n  } = await supabase.from('mensajes').select(`\n      *,\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\n        id,\n        nombre,\n        apellido,\n        grado,\n        seccion\n      )\n    `).eq('remitente_id', docenteId).not('estudiante_id', 'is', null).order('created_at', {\n    ascending: false\n  });\n  if (error) throw error;\n\n  // agrupar por estudiante\n  const conversacionesMap = new Map();\n  (mensajes || []).forEach(msg => {\n    if (!msg.estudiante) return;\n    const estudianteId = msg.estudiante.id;\n    if (!conversacionesMap.has(estudianteId)) {\n      conversacionesMap.set(estudianteId, {\n        estudiante_id: estudianteId,\n        estudiante_nombre: msg.estudiante.nombre,\n        estudiante_apellido: msg.estudiante.apellido,\n        estudiante_grado: msg.estudiante.grado,\n        estudiante_seccion: msg.estudiante.seccion,\n        ultimo_mensaje: msg.mensaje,\n        ultimo_mensaje_fecha: msg.created_at,\n        ultimo_mensaje_tipo: msg.tipo || 'general',\n        mensajes_no_leidos: msg.leido ? 0 : 1,\n        total_mensajes: 1\n      });\n    } else {\n      const conv = conversacionesMap.get(estudianteId);\n      conv.total_mensajes++;\n      if (!msg.leido) {\n        conv.mensajes_no_leidos++;\n      }\n    }\n  });\n  return Array.from(conversacionesMap.values()).sort((a, b) => new Date(b.ultimo_mensaje_fecha).getTime() - new Date(a.ultimo_mensaje_fecha).getTime());\n};\n\n// obtener mensajes de un estudiante específico (con información del docente)\nexport const getMensajesPorEstudiante = async estudianteId => {\n  // Primero obtenemos los mensajes\n  const {\n    data: mensajes,\n    error\n  } = await supabase.from('mensajes').select(`\n      *,\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\n        id,\n        nombre,\n        apellido,\n        grado,\n        seccion,\n        email\n      )\n    `).eq('estudiante_id', estudianteId).order('created_at', {\n    ascending: true\n  });\n  if (error) throw error;\n  if (!mensajes) return [];\n\n  // Obtener IDs únicos de docentes\n  const docenteIds = Array.from(new Set(mensajes.filter(m => m.remitente_tipo === 'docente').map(m => m.remitente_id)));\n\n  // Obtener información de docentes si hay\n  let docentes = [];\n  if (docenteIds.length > 0) {\n    const {\n      data: docentesData\n    } = await supabase.from('docentes').select('id, nombre, apellido, especialidad').in('id', docenteIds);\n    docentes = docentesData || [];\n  }\n\n  // Combinar la información\n  return mensajes.map(mensaje => ({\n    ...mensaje,\n    docente: mensaje.remitente_tipo === 'docente' ? docentes.find(d => d.id === mensaje.remitente_id) : undefined\n  }));\n};\n\n// obtener mensajes entre un docente y un estudiante específico (conversación privada)\nexport const getMensajesConversacionPrivada = async (docenteId, estudianteId) => {\n  // Obtener mensajes donde:\n  // 1. El estudiante es el destinatario Y el docente es el remitente\n  // 2. O el estudiante es el remitente (respuesta)\n  const {\n    data: mensajes,\n    error\n  } = await supabase.from('mensajes').select(`\n      *,\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\n        id,\n        nombre,\n        apellido,\n        grado,\n        seccion,\n        email\n      )\n    `).eq('estudiante_id', estudianteId).or(`and(remitente_tipo.eq.docente,remitente_id.eq.${docenteId}),and(remitente_tipo.eq.estudiante,remitente_id.eq.${estudianteId})`).order('created_at', {\n    ascending: true\n  });\n  if (error) throw error;\n  if (!mensajes) return [];\n\n  // Obtener información del docente\n  const {\n    data: docenteData\n  } = await supabase.from('docentes').select('id, nombre, apellido, especialidad').eq('id', docenteId).single();\n\n  // Agregar información del docente a los mensajes\n  return mensajes.map(mensaje => ({\n    ...mensaje,\n    docente: mensaje.remitente_tipo === 'docente' && mensaje.remitente_id === docenteId ? docenteData : undefined\n  }));\n};\n\n// obtener todos los mensajes del docente\nexport const getMensajesDocente = async docenteId => {\n  const {\n    data,\n    error\n  } = await supabase.from('mensajes').select(`\n      *,\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\n        id,\n        nombre,\n        apellido,\n        grado,\n        seccion,\n        email\n      )\n    `).eq('remitente_id', docenteId).order('created_at', {\n    ascending: false\n  });\n  if (error) throw error;\n  return data || [];\n};\n\n// marcar mensaje como leído\nexport const marcarComoLeido = async mensajeId => {\n  const {\n    error\n  } = await supabase.from('mensajes').update({\n    leido: true,\n    fecha_lectura: new Date().toISOString()\n  }).eq('id', mensajeId);\n  if (error) throw error;\n};\n\n// marcar todos los mensajes de una conversación específica como leídos\nexport const marcarConversacionLeida = async (estudianteId, docenteId) => {\n  let query = supabase.from('mensajes').update({\n    leido: true,\n    fecha_lectura: new Date().toISOString()\n  }).eq('estudiante_id', estudianteId).eq('leido', false);\n\n  // Si se proporciona docenteId, solo marcar mensajes de ese docente\n  if (docenteId) {\n    query = query.eq('remitente_id', docenteId);\n  }\n  const {\n    error\n  } = await query;\n  if (error) throw error;\n};\n\n// actualizar un mensaje\nexport const actualizarMensaje = async (id, cambios) => {\n  const {\n    data,\n    error\n  } = await supabase.from('mensajes').update(cambios).eq('id', id).select().single();\n  if (error) throw error;\n  return data;\n};\n\n// eliminar un mensaje\nexport const eliminarMensaje = async id => {\n  const {\n    error\n  } = await supabase.from('mensajes').delete().eq('id', id);\n  if (error) throw error;\n};\n\n// buscar mensajes\nexport const buscarMensajes = async (termino, docenteId) => {\n  const {\n    data,\n    error\n  } = await supabase.from('mensajes').select(`\n      *,\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\n        id,\n        nombre,\n        apellido,\n        grado,\n        seccion,\n        email\n      )\n    `).eq('remitente_id', docenteId).or(`asunto.ilike.%${termino}%,mensaje.ilike.%${termino}%`).order('created_at', {\n    ascending: false\n  });\n  if (error) throw error;\n  return data || [];\n};\n\n// obtener estadísticas de mensajería\nexport const getEstadisticasMensajes = async docenteId => {\n  const {\n    data: mensajes,\n    error\n  } = await supabase.from('mensajes').select('id, tipo, leido').eq('remitente_id', docenteId);\n  if (error) throw error;\n  const total = (mensajes === null || mensajes === void 0 ? void 0 : mensajes.length) || 0;\n  const noLeidos = (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => !m.leido).length) || 0;\n  const porTipo = {\n    general: (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => m.tipo === 'general').length) || 0,\n    urgente: (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => m.tipo === 'urgente').length) || 0,\n    academico: (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => m.tipo === 'academico').length) || 0,\n    conductual: (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => m.tipo === 'conductual').length) || 0,\n    felicitacion: (mensajes === null || mensajes === void 0 ? void 0 : mensajes.filter(m => m.tipo === 'felicitacion').length) || 0\n  };\n  return {\n    total,\n    noLeidos,\n    leidos: total - noLeidos,\n    porTipo\n  };\n};","map":{"version":3,"names":["supabase","crearMensaje","mensaje","data","error","from","insert","select","single","getConversaciones","docenteId","mensajes","eq","not","order","ascending","conversacionesMap","Map","forEach","msg","estudiante","estudianteId","id","has","set","estudiante_id","estudiante_nombre","nombre","estudiante_apellido","apellido","estudiante_grado","grado","estudiante_seccion","seccion","ultimo_mensaje","ultimo_mensaje_fecha","created_at","ultimo_mensaje_tipo","tipo","mensajes_no_leidos","leido","total_mensajes","conv","get","Array","values","sort","a","b","Date","getTime","getMensajesPorEstudiante","docenteIds","Set","filter","m","remitente_tipo","map","remitente_id","docentes","length","docentesData","in","docente","find","d","undefined","getMensajesConversacionPrivada","or","docenteData","getMensajesDocente","marcarComoLeido","mensajeId","update","fecha_lectura","toISOString","marcarConversacionLeida","query","actualizarMensaje","cambios","eliminarMensaje","delete","buscarMensajes","termino","getEstadisticasMensajes","total","noLeidos","porTipo","general","urgente","academico","conductual","felicitacion","leidos"],"sources":["C:/Users/diego/OneDrive/Escritorio/ProyectoAPT/CapStone-710V-/src/services/mensajeService.ts"],"sourcesContent":["import { supabase } from '../supabaseClient';\r\nimport { Mensaje } from '../types/database';\r\n\r\n// interfaz extendida con información del estudiante y docente\r\nexport interface MensajeConDetalles extends Mensaje {\r\n  estudiante?: {\r\n    id: number;\r\n    nombre: string;\r\n    apellido: string;\r\n    grado?: string;\r\n    seccion?: string;\r\n    email?: string;\r\n  };\r\n  docente?: {\r\n    id: number;\r\n    nombre: string;\r\n    apellido: string;\r\n    especialidad?: string;\r\n  };\r\n}\r\n\r\n// interfaz para agrupar mensajes por conversación (docente)\r\nexport interface Conversacion {\r\n  estudiante_id: number;\r\n  estudiante_nombre: string;\r\n  estudiante_apellido: string;\r\n  estudiante_grado?: string;\r\n  estudiante_seccion?: string;\r\n  ultimo_mensaje: string;\r\n  ultimo_mensaje_fecha: string;\r\n  ultimo_mensaje_tipo: string;\r\n  mensajes_no_leidos: number;\r\n  total_mensajes: number;\r\n}\r\n\r\n// interfaz para conversaciones del estudiante\r\nexport interface ConversacionEstudiante {\r\n  docente_id: number;\r\n  docente_nombre: string;\r\n  docente_apellido: string;\r\n  docente_especialidad?: string;\r\n  ultimo_mensaje: string;\r\n  ultimo_mensaje_fecha: string;\r\n  ultimo_mensaje_tipo: string;\r\n  mensajes_no_leidos: number;\r\n  total_mensajes: number;\r\n}\r\n\r\n// crear un mensaje\r\nexport const crearMensaje = async (mensaje: Omit<Mensaje, 'id' | 'created_at'>): Promise<Mensaje> => {\r\n  const { data, error } = await supabase\r\n    .from('mensajes')\r\n    .insert(mensaje)\r\n    .select()\r\n    .single();\r\n\r\n  if (error) throw error;\r\n  return data;\r\n};\r\n\r\n// obtener todas las conversaciones agrupadas por estudiante\r\nexport const getConversaciones = async (docenteId: number): Promise<Conversacion[]> => {\r\n  // obtener todos los mensajes donde el docente es remitente\r\n  const { data: mensajes, error } = await supabase\r\n    .from('mensajes')\r\n    .select(`\r\n      *,\r\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\r\n        id,\r\n        nombre,\r\n        apellido,\r\n        grado,\r\n        seccion\r\n      )\r\n    `)\r\n    .eq('remitente_id', docenteId)\r\n    .not('estudiante_id', 'is', null)\r\n    .order('created_at', { ascending: false });\r\n\r\n  if (error) throw error;\r\n\r\n  // agrupar por estudiante\r\n  const conversacionesMap = new Map<number, Conversacion>();\r\n\r\n  (mensajes || []).forEach((msg: any) => {\r\n    if (!msg.estudiante) return;\r\n\r\n    const estudianteId = msg.estudiante.id;\r\n\r\n    if (!conversacionesMap.has(estudianteId)) {\r\n      conversacionesMap.set(estudianteId, {\r\n        estudiante_id: estudianteId,\r\n        estudiante_nombre: msg.estudiante.nombre,\r\n        estudiante_apellido: msg.estudiante.apellido,\r\n        estudiante_grado: msg.estudiante.grado,\r\n        estudiante_seccion: msg.estudiante.seccion,\r\n        ultimo_mensaje: msg.mensaje,\r\n        ultimo_mensaje_fecha: msg.created_at,\r\n        ultimo_mensaje_tipo: msg.tipo || 'general',\r\n        mensajes_no_leidos: msg.leido ? 0 : 1,\r\n        total_mensajes: 1\r\n      });\r\n    } else {\r\n      const conv = conversacionesMap.get(estudianteId)!;\r\n      conv.total_mensajes++;\r\n      if (!msg.leido) {\r\n        conv.mensajes_no_leidos++;\r\n      }\r\n    }\r\n  });\r\n\r\n  return Array.from(conversacionesMap.values()).sort((a, b) => \r\n    new Date(b.ultimo_mensaje_fecha).getTime() - new Date(a.ultimo_mensaje_fecha).getTime()\r\n  );\r\n};\r\n\r\n// obtener mensajes de un estudiante específico (con información del docente)\r\nexport const getMensajesPorEstudiante = async (\r\n  estudianteId: number\r\n): Promise<MensajeConDetalles[]> => {\r\n  // Primero obtenemos los mensajes\r\n  const { data: mensajes, error } = await supabase\r\n    .from('mensajes')\r\n    .select(`\r\n      *,\r\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\r\n        id,\r\n        nombre,\r\n        apellido,\r\n        grado,\r\n        seccion,\r\n        email\r\n      )\r\n    `)\r\n    .eq('estudiante_id', estudianteId)\r\n    .order('created_at', { ascending: true });\r\n\r\n  if (error) throw error;\r\n  if (!mensajes) return [];\r\n\r\n  // Obtener IDs únicos de docentes\r\n  const docenteIds = Array.from(new Set(\r\n    mensajes\r\n      .filter(m => m.remitente_tipo === 'docente')\r\n      .map(m => m.remitente_id)\r\n  ));\r\n\r\n  // Obtener información de docentes si hay\r\n  let docentes: any[] = [];\r\n  if (docenteIds.length > 0) {\r\n    const { data: docentesData } = await supabase\r\n      .from('docentes')\r\n      .select('id, nombre, apellido, especialidad')\r\n      .in('id', docenteIds);\r\n    \r\n    docentes = docentesData || [];\r\n  }\r\n\r\n  // Combinar la información\r\n  return mensajes.map(mensaje => ({\r\n    ...mensaje,\r\n    docente: mensaje.remitente_tipo === 'docente' \r\n      ? docentes.find(d => d.id === mensaje.remitente_id)\r\n      : undefined\r\n  }));\r\n};\r\n\r\n// obtener mensajes entre un docente y un estudiante específico (conversación privada)\r\nexport const getMensajesConversacionPrivada = async (\r\n  docenteId: number,\r\n  estudianteId: number\r\n): Promise<MensajeConDetalles[]> => {\r\n  // Obtener mensajes donde:\r\n  // 1. El estudiante es el destinatario Y el docente es el remitente\r\n  // 2. O el estudiante es el remitente (respuesta)\r\n  const { data: mensajes, error } = await supabase\r\n    .from('mensajes')\r\n    .select(`\r\n      *,\r\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\r\n        id,\r\n        nombre,\r\n        apellido,\r\n        grado,\r\n        seccion,\r\n        email\r\n      )\r\n    `)\r\n    .eq('estudiante_id', estudianteId)\r\n    .or(`and(remitente_tipo.eq.docente,remitente_id.eq.${docenteId}),and(remitente_tipo.eq.estudiante,remitente_id.eq.${estudianteId})`)\r\n    .order('created_at', { ascending: true });\r\n\r\n  if (error) throw error;\r\n  if (!mensajes) return [];\r\n\r\n  // Obtener información del docente\r\n  const { data: docenteData } = await supabase\r\n    .from('docentes')\r\n    .select('id, nombre, apellido, especialidad')\r\n    .eq('id', docenteId)\r\n    .single();\r\n\r\n  // Agregar información del docente a los mensajes\r\n  return mensajes.map(mensaje => ({\r\n    ...mensaje,\r\n    docente: mensaje.remitente_tipo === 'docente' && mensaje.remitente_id === docenteId\r\n      ? docenteData\r\n      : undefined\r\n  }));\r\n};\r\n\r\n// obtener todos los mensajes del docente\r\nexport const getMensajesDocente = async (docenteId: number): Promise<MensajeConDetalles[]> => {\r\n  const { data, error } = await supabase\r\n    .from('mensajes')\r\n    .select(`\r\n      *,\r\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\r\n        id,\r\n        nombre,\r\n        apellido,\r\n        grado,\r\n        seccion,\r\n        email\r\n      )\r\n    `)\r\n    .eq('remitente_id', docenteId)\r\n    .order('created_at', { ascending: false });\r\n\r\n  if (error) throw error;\r\n  return data || [];\r\n};\r\n\r\n// marcar mensaje como leído\r\nexport const marcarComoLeido = async (mensajeId: number): Promise<void> => {\r\n  const { error } = await supabase\r\n    .from('mensajes')\r\n    .update({ \r\n      leido: true,\r\n      fecha_lectura: new Date().toISOString()\r\n    })\r\n    .eq('id', mensajeId);\r\n\r\n  if (error) throw error;\r\n};\r\n\r\n// marcar todos los mensajes de una conversación específica como leídos\r\nexport const marcarConversacionLeida = async (\r\n  estudianteId: number,\r\n  docenteId?: number\r\n): Promise<void> => {\r\n  let query = supabase\r\n    .from('mensajes')\r\n    .update({ \r\n      leido: true,\r\n      fecha_lectura: new Date().toISOString()\r\n    })\r\n    .eq('estudiante_id', estudianteId)\r\n    .eq('leido', false);\r\n\r\n  // Si se proporciona docenteId, solo marcar mensajes de ese docente\r\n  if (docenteId) {\r\n    query = query.eq('remitente_id', docenteId);\r\n  }\r\n\r\n  const { error } = await query;\r\n  if (error) throw error;\r\n};\r\n\r\n// actualizar un mensaje\r\nexport const actualizarMensaje = async (\r\n  id: number,\r\n  cambios: Partial<Mensaje>\r\n): Promise<Mensaje> => {\r\n  const { data, error } = await supabase\r\n    .from('mensajes')\r\n    .update(cambios)\r\n    .eq('id', id)\r\n    .select()\r\n    .single();\r\n\r\n  if (error) throw error;\r\n  return data;\r\n};\r\n\r\n// eliminar un mensaje\r\nexport const eliminarMensaje = async (id: number): Promise<void> => {\r\n  const { error } = await supabase\r\n    .from('mensajes')\r\n    .delete()\r\n    .eq('id', id);\r\n\r\n  if (error) throw error;\r\n};\r\n\r\n// buscar mensajes\r\nexport const buscarMensajes = async (\r\n  termino: string,\r\n  docenteId: number\r\n): Promise<MensajeConDetalles[]> => {\r\n  const { data, error } = await supabase\r\n    .from('mensajes')\r\n    .select(`\r\n      *,\r\n      estudiante:Estudiantes!mensajes_estudiante_id_fkey (\r\n        id,\r\n        nombre,\r\n        apellido,\r\n        grado,\r\n        seccion,\r\n        email\r\n      )\r\n    `)\r\n    .eq('remitente_id', docenteId)\r\n    .or(`asunto.ilike.%${termino}%,mensaje.ilike.%${termino}%`)\r\n    .order('created_at', { ascending: false });\r\n\r\n  if (error) throw error;\r\n  return data || [];\r\n};\r\n\r\n// obtener estadísticas de mensajería\r\nexport const getEstadisticasMensajes = async (docenteId: number) => {\r\n  const { data: mensajes, error } = await supabase\r\n    .from('mensajes')\r\n    .select('id, tipo, leido')\r\n    .eq('remitente_id', docenteId);\r\n\r\n  if (error) throw error;\r\n\r\n  const total = mensajes?.length || 0;\r\n  const noLeidos = mensajes?.filter(m => !m.leido).length || 0;\r\n  const porTipo = {\r\n    general: mensajes?.filter(m => m.tipo === 'general').length || 0,\r\n    urgente: mensajes?.filter(m => m.tipo === 'urgente').length || 0,\r\n    academico: mensajes?.filter(m => m.tipo === 'academico').length || 0,\r\n    conductual: mensajes?.filter(m => m.tipo === 'conductual').length || 0,\r\n    felicitacion: mensajes?.filter(m => m.tipo === 'felicitacion').length || 0\r\n  };\r\n\r\n  return {\r\n    total,\r\n    noLeidos,\r\n    leidos: total - noLeidos,\r\n    porTipo\r\n  };\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}